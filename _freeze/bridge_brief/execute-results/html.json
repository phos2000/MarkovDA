{
  "hash": "a8f37abdcdf62c27a7058f39c0b5f493",
  "result": {
    "markdown": "---\ntitle: \"BRIDGE Report\"\nauthor: \"Astrid Yu, Ashley Leech\"\ndate: \"2023-07-12\"\nformat: \n  html: \n    toc: true\n    code-fold: true\n    code-summary: \"Show the code\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"~/Documents/GitHub/MarkovDA/data/with-drop-out.rda\")\n```\n:::\n\n\n# Methods\n\n## Participants\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfu %>% distinct(study_arm,record_id) %>% count(study_arm) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   study_arm   n\n1:       EUC 893\n2:       TSC 899\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfu %>%\n  filter(reason == 1) %>%\n  distinct(study_arm,record_id) %>% count(study_arm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   study_arm   n\n1:       EUC 719\n2:       TSC 743\n```\n:::\n:::\n\n\n### Drop-outs\n\nDrop-outs are participants that has been terminated for their own reasons: moving, unable to contact, refusing to join in and so on.\n\nAlthough the drop-out rate is more than 10%, the result of our analysis don't have a evident difference. So we include the records of participants who have been terminated without completion.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfu %>%\n  filter(reason != 1) %>%\n  distinct(study_arm,record_id) %>% count(study_arm) %>% rename(drop_out = n) %>%\n  left_join(fu %>% distinct(study_arm,record_id) %>% count(study_arm)) %>%\n  mutate(pct = percent(drop_out/n)) %>% select(-n) %>%\n  kable(caption = \"percent of drop-outs in 2 arms\") %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>percent of drop-outs in 2 arms</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:right;\"> drop_out </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:right;\"> 165 </td>\n   <td style=\"text-align:left;\"> 18.5% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:right;\"> 136 </td>\n   <td style=\"text-align:left;\"> 15.1% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### demographic\n\n-   gender\n-   city\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngender = fu %>% filter(!is.na(gender)) %>% distinct(record_id, gender, study_arm) \n\ngender %>%\n  mutate(gender=factor(gender,levels=1:2,labels=c(\"Female\",\"Male\"))) %>%\n  count(study_arm, gender) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable(caption = \"Gender in 2 arms for all participants(including drop-outs)\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gender in 2 arms for all participants(including drop-outs)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> gender </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 319 </td>\n   <td style=\"text-align:left;\"> 36% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 573 </td>\n   <td style=\"text-align:left;\"> 64% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 320 </td>\n   <td style=\"text-align:left;\"> 36% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 579 </td>\n   <td style=\"text-align:left;\"> 64% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nlocation = fu %>% filter(!is.na(city)) %>% distinct(record_id, city, study_arm) \n\nlocation %>%\n  count(study_arm, city) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable(caption = \"City in 2 arms for all participants(including drop-outs)\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>City in 2 arms for all participants(including drop-outs)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> city </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 210 </td>\n   <td style=\"text-align:left;\"> 23.5% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 443 </td>\n   <td style=\"text-align:left;\"> 49.6% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 240 </td>\n   <td style=\"text-align:left;\"> 26.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 234 </td>\n   <td style=\"text-align:left;\"> 26.0% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 449 </td>\n   <td style=\"text-align:left;\"> 49.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 216 </td>\n   <td style=\"text-align:left;\"> 24.0% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ndob = fu %>% mutate(bd=as_date(dob)) %>% filter(!is.na(bd)) %>% distinct(record_id,study_arm,bd)\n\nfu %>% filter(reason == 1) %>% distinct(record_id) %>% \n  left_join(fu%>% filter(!is.na(gender)) %>% distinct(record_id, gender, study_arm)) %>%\n  mutate(gender=factor(gender,levels=1:2,labels=c(\"Female\",\"Male\"))) %>%\n  count(study_arm, gender) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable(caption = \"Gender in 2 arms for completed participants\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gender in 2 arms for completed participants</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> gender </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 266 </td>\n   <td style=\"text-align:left;\"> 37% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 453 </td>\n   <td style=\"text-align:left;\"> 63% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 261 </td>\n   <td style=\"text-align:left;\"> 35% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 482 </td>\n   <td style=\"text-align:left;\"> 65% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nfu %>% filter(reason == 1) %>% distinct(record_id) %>% \n  left_join(fu %>% filter(!is.na(city)) %>% distinct(record_id, city, study_arm)) %>%\n  count(study_arm, city) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable(caption = \"City in 2 arms for completed participants\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>City in 2 arms for completed participants</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> city </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 153 </td>\n   <td style=\"text-align:left;\"> 21.3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:left;\"> 51.3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 197 </td>\n   <td style=\"text-align:left;\"> 27.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 179 </td>\n   <td style=\"text-align:left;\"> 24.1% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 393 </td>\n   <td style=\"text-align:left;\"> 52.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 171 </td>\n   <td style=\"text-align:left;\"> 23.0% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### intervals\n\n**Expected schedule of follow-up visits** Only the first follow-up needs to be +/- 3 days, all else allow +/- 14 days.\\\n*Schedule:*\\\n\\* instance 1 - Week 1\\\n\\* instance 2 - Month 1\\\n\\* instance 3 - Month 2\\\n\\* instance 4 - Month 4\\\n\\* instance 5 - Month 6\\\n\\* instance 6 - Month 9\\\n\\* instance 7 - Month 12\\\n\\* instance 8 - Month 15\\\n\\* instance 9 - Month 18\\\n\\* instance 10 - Month 24\\\n*Expected time interval:*\\\n\\* v1: 7 +/- 3 from v0\\\n\\* v2: 28 +/- 14 from v0\\\n\\* v3: 28 +/- 14 from v2\\\n\\* v4: 56 +/- 14 from v3\\\n\\* v5: 56 +/- 14 from v4\\\n\\* v6: 84 +/- 14 from v5\\\n\\* v7: 84 +/- 14 from v6\\\n\\* v8: 84 +/- 14 from v7\\\n\\* v9: 84 +/- 14 from v8\\\n\\* v10: 168 +/- 14 from v9\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbasedate = fu %>% filter(redcap_repeat_instrument==\"diag_enroll\") %>% \n  mutate(datebaseline = as_date(ifelse(ev0 == 1, date_of_consent_screen, dateconsentenroll))) %>% \n  select(record_id, study_arm, ev0, datebaseline) %>% left_join(dob, by = c(\"record_id\", \"study_arm\")) %>% \n  mutate(age = round(as.numeric(datebaseline - bd)/365.25,1))\n\nfudw <- fu %>% filter(redcap_repeat_instrument==\"follow_up_care_form\") %>%\n  select(record_id,study_arm,visit = redcap_repeat_instance,datefu,age = agefu) %>% \n  mutate(date=as_date(datefu), visit=as.numeric(visit)) %>% select(-datefu) %>%\n  bind_rows(basedate %>% select(record_id,study_arm,date = datebaseline,age) %>% mutate(visit=0)) %>%\n  pivot_wider(names_from = visit,\n              values_from = c(date,age)) %>% \n  select(-date_11, -age_11) %>%\n  mutate(d01=as.integer(date_1-date_0),\n         d12=as.integer(date_2-date_1),\n         d23=as.integer(date_3-date_2),\n         d34=as.integer(date_4-date_3),\n         d45=as.integer(date_5-date_4),\n         d56=as.integer(date_6-date_5),\n         d67=as.integer(date_7-date_6),\n         d78=as.integer(date_8-date_7),\n         d89=as.integer(date_9-date_8),\n         d90=as.integer(date_10-date_9))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfudw %>% filter(study_arm==\"EUC\") %>% \n  select(starts_with(\"d\")) %>% \n  select(-starts_with(\"date\")) %>% \n  summary() %>% kable(caption=\"Range of intervals between follow up visits, EUC\")  %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Range of intervals between follow up visits, EUC</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\">      d01 </th>\n   <th style=\"text-align:left;\">      d12 </th>\n   <th style=\"text-align:left;\">      d23 </th>\n   <th style=\"text-align:left;\">      d34 </th>\n   <th style=\"text-align:left;\">      d45 </th>\n   <th style=\"text-align:left;\">      d56 </th>\n   <th style=\"text-align:left;\">      d67 </th>\n   <th style=\"text-align:left;\">      d78 </th>\n   <th style=\"text-align:left;\">      d89 </th>\n   <th style=\"text-align:left;\">      d90 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Min.   :-28.000 </td>\n   <td style=\"text-align:left;\"> Min.   :-40.00 </td>\n   <td style=\"text-align:left;\"> Min.   : 0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :-12.00 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.0 </td>\n   <td style=\"text-align:left;\"> Min.   : 40.00 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.00 </td>\n   <td style=\"text-align:left;\"> Min.   : 13.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 1st Qu.:  7.000 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 21.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:28.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 83.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 84.0 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 83.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 82.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:167.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Median :  7.000 </td>\n   <td style=\"text-align:left;\"> Median : 21.00 </td>\n   <td style=\"text-align:left;\"> Median :28.00 </td>\n   <td style=\"text-align:left;\"> Median : 56.00 </td>\n   <td style=\"text-align:left;\"> Median : 56.00 </td>\n   <td style=\"text-align:left;\"> Median : 84.00 </td>\n   <td style=\"text-align:left;\"> Median : 84.0 </td>\n   <td style=\"text-align:left;\"> Median : 84.00 </td>\n   <td style=\"text-align:left;\"> Median : 84.00 </td>\n   <td style=\"text-align:left;\"> Median :168.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Mean   :  8.579 </td>\n   <td style=\"text-align:left;\"> Mean   : 22.09 </td>\n   <td style=\"text-align:left;\"> Mean   :28.49 </td>\n   <td style=\"text-align:left;\"> Mean   : 54.82 </td>\n   <td style=\"text-align:left;\"> Mean   : 55.51 </td>\n   <td style=\"text-align:left;\"> Mean   : 83.23 </td>\n   <td style=\"text-align:left;\"> Mean   : 84.3 </td>\n   <td style=\"text-align:left;\"> Mean   : 84.11 </td>\n   <td style=\"text-align:left;\"> Mean   : 82.89 </td>\n   <td style=\"text-align:left;\"> Mean   :168.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:  8.000 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 21.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:28.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 85.0 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:172.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Max.   :154.000 </td>\n   <td style=\"text-align:left;\"> Max.   :121.00 </td>\n   <td style=\"text-align:left;\"> Max.   :85.00 </td>\n   <td style=\"text-align:left;\"> Max.   :129.00 </td>\n   <td style=\"text-align:left;\"> Max.   :219.00 </td>\n   <td style=\"text-align:left;\"> Max.   :183.00 </td>\n   <td style=\"text-align:left;\"> Max.   :161.0 </td>\n   <td style=\"text-align:left;\"> Max.   :174.00 </td>\n   <td style=\"text-align:left;\"> Max.   :234.00 </td>\n   <td style=\"text-align:left;\"> Max.   :217.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> NA's   :9 </td>\n   <td style=\"text-align:left;\"> NA's   :18 </td>\n   <td style=\"text-align:left;\"> NA's   :33 </td>\n   <td style=\"text-align:left;\"> NA's   :49 </td>\n   <td style=\"text-align:left;\"> NA's   :78 </td>\n   <td style=\"text-align:left;\"> NA's   :104 </td>\n   <td style=\"text-align:left;\"> NA's   :117 </td>\n   <td style=\"text-align:left;\"> NA's   :126 </td>\n   <td style=\"text-align:left;\"> NA's   :142 </td>\n   <td style=\"text-align:left;\"> NA's   :156 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nfudw %>% filter(study_arm==\"TSC\") %>% \n  select(starts_with(\"d\")) %>% \n  select(-starts_with(\"date\")) %>% \n  summary() %>% kable(caption=\"Range of intervals between follow up visits, TSC\")  %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Range of intervals between follow up visits, TSC</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\">      d01 </th>\n   <th style=\"text-align:left;\">      d12 </th>\n   <th style=\"text-align:left;\">      d23 </th>\n   <th style=\"text-align:left;\">      d34 </th>\n   <th style=\"text-align:left;\">      d45 </th>\n   <th style=\"text-align:left;\">      d56 </th>\n   <th style=\"text-align:left;\">      d67 </th>\n   <th style=\"text-align:left;\">      d78 </th>\n   <th style=\"text-align:left;\">      d89 </th>\n   <th style=\"text-align:left;\">      d90 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Min.   :-307.000 </td>\n   <td style=\"text-align:left;\"> Min.   :-10.00 </td>\n   <td style=\"text-align:left;\"> Min.   :-56.00 </td>\n   <td style=\"text-align:left;\"> Min.   :-49.00 </td>\n   <td style=\"text-align:left;\"> Min.   : -7.00 </td>\n   <td style=\"text-align:left;\"> Min.   :-281.00 </td>\n   <td style=\"text-align:left;\"> Min.   : 11.00 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :-650.00 </td>\n   <td style=\"text-align:left;\"> Min.   :-198.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 1st Qu.:   7.000 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 21.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 28.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:  84.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:  82.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 167.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Median :   7.000 </td>\n   <td style=\"text-align:left;\"> Median : 21.00 </td>\n   <td style=\"text-align:left;\"> Median : 28.00 </td>\n   <td style=\"text-align:left;\"> Median : 56.00 </td>\n   <td style=\"text-align:left;\"> Median : 56.00 </td>\n   <td style=\"text-align:left;\"> Median :  84.00 </td>\n   <td style=\"text-align:left;\"> Median : 84.00 </td>\n   <td style=\"text-align:left;\"> Median : 84.00 </td>\n   <td style=\"text-align:left;\"> Median :  84.00 </td>\n   <td style=\"text-align:left;\"> Median : 168.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Mean   :   7.656 </td>\n   <td style=\"text-align:left;\"> Mean   : 22.93 </td>\n   <td style=\"text-align:left;\"> Mean   : 29.25 </td>\n   <td style=\"text-align:left;\"> Mean   : 54.34 </td>\n   <td style=\"text-align:left;\"> Mean   : 55.48 </td>\n   <td style=\"text-align:left;\"> Mean   :  83.19 </td>\n   <td style=\"text-align:left;\"> Mean   : 84.45 </td>\n   <td style=\"text-align:left;\"> Mean   : 83.78 </td>\n   <td style=\"text-align:left;\"> Mean   :  83.08 </td>\n   <td style=\"text-align:left;\"> Mean   : 169.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:   8.000 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 23.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 28.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 56.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:  84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:  84.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 171.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Max.   : 103.000 </td>\n   <td style=\"text-align:left;\"> Max.   :153.00 </td>\n   <td style=\"text-align:left;\"> Max.   :169.00 </td>\n   <td style=\"text-align:left;\"> Max.   :167.00 </td>\n   <td style=\"text-align:left;\"> Max.   :112.00 </td>\n   <td style=\"text-align:left;\"> Max.   : 157.00 </td>\n   <td style=\"text-align:left;\"> Max.   :448.00 </td>\n   <td style=\"text-align:left;\"> Max.   :168.00 </td>\n   <td style=\"text-align:left;\"> Max.   : 445.00 </td>\n   <td style=\"text-align:left;\"> Max.   : 901.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> NA's   :28 </td>\n   <td style=\"text-align:left;\"> NA's   :39 </td>\n   <td style=\"text-align:left;\"> NA's   :55 </td>\n   <td style=\"text-align:left;\"> NA's   :68 </td>\n   <td style=\"text-align:left;\"> NA's   :80 </td>\n   <td style=\"text-align:left;\"> NA's   :91 </td>\n   <td style=\"text-align:left;\"> NA's   :105 </td>\n   <td style=\"text-align:left;\"> NA's   :109 </td>\n   <td style=\"text-align:left;\"> NA's   :117 </td>\n   <td style=\"text-align:left;\"> NA's   :135 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\npf <- function(v,m,t) {\n  vv <- enquo(v)\n  m1 <- fudw %>% pull(!!vv) %>% min(na.rm = T)\n  m2 <- fudw %>% pull(!!vv) %>% max(na.rm = T)\n  \n  p <- fudw %>% ggplot(aes(x=study_arm,y=!!vv)) +\n    geom_boxplot() +\n    scale_y_continuous(breaks = c(m1,-100,0,m,100,m2))  +\n    coord_flip() + theme_minimal() +\n    ggtitle(t)\n  print(p)\n}\n\npf(d01,7,\"Baseline-FU1: expected 1 week\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-1.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d12,21,\"FU1-FU2: expected 3 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-2.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d23,28,\"FU2-FU3: expected 4 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-3.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d34,56,\"FU3-FU4: expected 8 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-4.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d45,56,\"FU4-FU5: expected 8 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-5.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d56,84,\"FU5-FU6: expected 12 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-6.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d67,84,\"FU6-FU7: expected 12 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-7.png){width=672}\n:::\n\n```{.r .cell-code}\npf(d78,84,\"FU7-FU8: expected 12 weeks\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/interval-8.png){width=672}\n:::\n:::\n\n\n## Instruments\n\n-   VAS\n    -   For all ages, for all follow up visits\n-   QOLIE\n    -   QOLIE-AD-48: for 11 \\< age \\< 17\n\n    -   QOLIE-31: for age \\> 17\n\n    -   3 times totally, should be screening(month 0), month 2, month 24.\n\n    -   **Question 16 and 18 (Cramer, 1999) in QOLIE-AD-48** are missing and then ignored from the survey.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n####score qolie 31####\n\nscore_q31 <- function(df) {\n  d1 <- df %>% mutate(\n    #seizure worry\n    sw1=ifelse(q11==1,0,NA),\n    sw1=ifelse(q11==2,20, sw1),\n    sw1=ifelse(q11==3,40, sw1),\n    sw1=ifelse(q11==4,60, sw1),\n    sw1=ifelse(q11==5,80, sw1),\n    sw1=ifelse(q11==6,100,sw1),\n    \n    sw2=ifelse(q21==1,0,NA),\n    sw2=ifelse(q21==2,33.3,sw2),\n    sw2=ifelse(q21==3,66.7,sw2),\n    sw2=ifelse(q21==4,100, sw2),\n    \n    sw3=ifelse(q22==1,0,NA),\n    sw3=ifelse(q22==2,50, sw3),\n    sw3=ifelse(q22==3,100,sw3),\n    \n    sw4=ifelse(q23==1,0,NA),\n    sw4=ifelse(q23==2,33.3,sw4),\n    sw4=ifelse(q23==3,66.7,sw4),\n    sw4=ifelse(q23==4,100, sw4),\n    \n    sw5=ifelse(q25==1,100,NA),\n    sw5=ifelse(q25==2,75,sw5),\n    sw5=ifelse(q25==3,50,sw5),\n    sw5=ifelse(q25==4,25,sw5),\n    sw5=ifelse(q25==5,0, sw5)\n  ) %>% mutate(\n    #overall quality of life\n    ql1=q1*10,\n    \n    ql2=ifelse(q14==1,100,NA),\n    ql2=ifelse(q14==2,75,ql2),\n    ql2=ifelse(q14==3,50,ql2),\n    ql2=ifelse(q14==4,25,ql2),\n    ql2=ifelse(q14==5,0, ql2)\n  ) %>% mutate(\n    #emotional well-being\n    ew1=ifelse(q3==1,0,NA),\n    ew1=ifelse(q3==2,20, ew1),\n    ew1=ifelse(q3==3,40, ew1),\n    ew1=ifelse(q3==4,60, ew1),\n    ew1=ifelse(q3==5,80, ew1),\n    ew1=ifelse(q3==6,100,ew1),\n    \n    ew2=ifelse(q4==1,0,NA),\n    ew2=ifelse(q4==2,20, ew2),\n    ew2=ifelse(q4==3,40, ew2),\n    ew2=ifelse(q4==4,60, ew2),\n    ew2=ifelse(q4==5,80, ew2),\n    ew2=ifelse(q4==6,100,ew2),\n    \n    ew3=ifelse(q5==1,100,NA),\n    ew3=ifelse(q5==2,80,ew3),\n    ew3=ifelse(q5==3,60,ew3),\n    ew3=ifelse(q5==4,40,ew3),\n    ew3=ifelse(q5==5,20,ew3),\n    ew3=ifelse(q5==6,0, ew3),\n    \n    ew4=ifelse(q7==1,0,NA),\n    ew4=ifelse(q7==2,20, ew4),\n    ew4=ifelse(q7==3,40, ew4),\n    ew4=ifelse(q7==4,60, ew4),\n    ew4=ifelse(q7==5,80, ew4),\n    ew4=ifelse(q7==6,100,ew4),\n    \n    ew5=ifelse(q9==1,100,NA),\n    ew5=ifelse(q9==2,80,ew5),\n    ew5=ifelse(q9==3,60,ew5),\n    ew5=ifelse(q9==4,40,ew5),\n    ew5=ifelse(q9==5,20,ew5),\n    ew5=ifelse(q9==6,0, ew5),\n  ) %>% mutate(\n    #energy/fatigue\n    ef1=ifelse(q2==1,100,NA),\n    ef1=ifelse(q2==2,80,ef1),\n    ef1=ifelse(q2==3,60,ef1),\n    ef1=ifelse(q2==4,40,ef1),\n    ef1=ifelse(q2==5,20,ef1),\n    ef1=ifelse(q2==6,0, ef1),\n    \n    ef2=ifelse(q6==1,100,NA),\n    ef2=ifelse(q6==2,80,ef2),\n    ef2=ifelse(q6==3,60,ef2),\n    ef2=ifelse(q6==4,40,ef2),\n    ef2=ifelse(q6==5,20,ef2),\n    ef2=ifelse(q6==6,0, ef2),\n    \n    ef3=ifelse(q8==1,0,NA),\n    ef3=ifelse(q8==2,20, ef3),\n    ef3=ifelse(q8==3,40, ef3),\n    ef3=ifelse(q8==4,60, ef3),\n    ef3=ifelse(q8==5,80, ef3),\n    ef3=ifelse(q8==6,100,ef3),\n    \n    ef4=ifelse(q10==1,0,NA),\n    ef4=ifelse(q10==2,20, ef4),\n    ef4=ifelse(q10==3,40, ef4),\n    ef4=ifelse(q10==4,60, ef4),\n    ef4=ifelse(q10==5,80, ef4),\n    ef4=ifelse(q10==6,100,ef4),\n  ) %>% mutate(\n    #cognitive\n    cg1=ifelse(q12==1,0,NA),\n    cg1=ifelse(q12==2,20, cg1),\n    cg1=ifelse(q12==3,40, cg1),\n    cg1=ifelse(q12==4,60, cg1),\n    cg1=ifelse(q12==5,80, cg1),\n    cg1=ifelse(q12==6,100,cg1),\n    \n    cg2=ifelse(q15==1,0,NA),\n    cg2=ifelse(q15==2,33.3,cg2),\n    cg2=ifelse(q15==3,66.7,cg2),\n    cg2=ifelse(q15==4,100, cg2),\n    \n    cg3=ifelse(q16==1,0,NA),\n    cg3=ifelse(q16==2,20, cg3),\n    cg3=ifelse(q16==3,40, cg3),\n    cg3=ifelse(q16==4,60, cg3),\n    cg3=ifelse(q16==5,80, cg3),\n    cg3=ifelse(q16==6,100,cg3),\n    \n    cg4=ifelse(q17==1,0,NA),\n    cg4=ifelse(q17==2,20, cg4),\n    cg4=ifelse(q17==3,40, cg4),\n    cg4=ifelse(q17==4,60, cg4),\n    cg4=ifelse(q17==5,80, cg4),\n    cg4=ifelse(q17==6,100,cg4),\n    \n    cg5=ifelse(q18==1,0,NA),\n    cg5=ifelse(q18==2,20, cg5),\n    cg5=ifelse(q18==3,40, cg5),\n    cg5=ifelse(q18==4,60, cg5),\n    cg5=ifelse(q18==5,80, cg5),\n    cg5=ifelse(q18==6,100,cg5),\n    \n    cg6=ifelse(q26==1,100,NA),\n    cg6=ifelse(q26==2,75,cg6),\n    cg6=ifelse(q26==3,50,cg6),\n    cg6=ifelse(q26==4,25,cg6),\n    cg6=ifelse(q26==5,0, cg6)\n  ) %>% mutate(\n    #medication effects\n    me1=ifelse(q24==1,0,NA),\n    me1=ifelse(q24==2,33.3,me1),\n    me1=ifelse(q24==3,66.7,me1),\n    me1=ifelse(q24==4,100, me1),\n    \n    me2=ifelse(q29==1,100,NA),\n    me2=ifelse(q29==2,75,me2),\n    me2=ifelse(q29==3,50,me2),\n    me2=ifelse(q29==4,25,me2),\n    me2=ifelse(q29==5,0, me2),\n    \n    me3=ifelse(q30==1,100,NA),\n    me3=ifelse(q30==2,75,me3),\n    me3=ifelse(q30==3,50,me3),\n    me3=ifelse(q30==4,25,me3),\n    me3=ifelse(q30==5,0, me3)\n  ) %>% mutate(\n    #social function\n    sf1=ifelse(q13==1,0,NA),\n    sf1=ifelse(q13==2,20, sf1),\n    sf1=ifelse(q13==3,40, sf1),\n    sf1=ifelse(q13==4,60, sf1),\n    sf1=ifelse(q13==5,80, sf1),\n    sf1=ifelse(q13==6,100,sf1),\n    \n    sf2=ifelse(q19==1,0,NA),\n    sf2=ifelse(q19==2,25, sf2),\n    sf2=ifelse(q19==3,50, sf2),\n    sf2=ifelse(q19==4,75, sf2),\n    sf2=ifelse(q19==5,100,sf2),\n    \n    sf3=ifelse(q20==1,0,NA),\n    sf3=ifelse(q20==2,25, sf3),\n    sf3=ifelse(q20==3,50, sf3),\n    sf3=ifelse(q20==4,75, sf3),\n    sf3=ifelse(q20==5,100,sf3),\n    \n    sf4=ifelse(q27==1,100,NA),\n    sf4=ifelse(q27==2,75,sf4),\n    sf4=ifelse(q27==3,50,sf4),\n    sf4=ifelse(q27==4,25,sf4),\n    sf4=ifelse(q27==5,0, sf4),\n    \n    sf5=ifelse(q28==1,100,NA),\n    sf5=ifelse(q28==2,75,sf5),\n    sf5=ifelse(q28==3,50,sf5),\n    sf5=ifelse(q28==4,25,sf5),\n    sf5=ifelse(q28==5,0, sf5)\n  )\n  \n  #summarise: what to do with missing item? currently averaging by domain\n  d1 %>% rowwise() %>% \n    mutate(sum_sw=mean(c(sw1,sw2,sw3,sw4,sw5),na.rm = T),\n           sum_ql=mean(c(ql1,ql2),na.rm = T),\n           sum_ew=mean(c(ew1,ew2,ew3,ew4,ew5),na.rm = T),\n           sum_ef=mean(c(ef1,ef2,ef3,ef4),na.rm = T),\n           sum_cg=mean(c(cg1,cg2,cg3,cg4,cg5,cg6),na.rm = T),\n           sum_me=mean(c(me1,me2,me3),na.rm = T),\n           sum_sf=mean(c(sf1,sf2,sf3,sf4,sf5),na.rm = T)\n    ) %>% ungroup() %>% \n    mutate(overall=sum_sw*0.08+sum_ql*0.14+sum_ew*0.15+sum_ef*0.12+\n             sum_cg*0.27+sum_me*0.03+sum_sf*0.21)\n  #what if missing one domain?\n  # return(d2)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# score for questions that have 5-point\nsc5 <- function(dt,vf,vt) {\n  v1 <- vf\n  v1 <- ensym(v1)\n  dd <- dt %>% select(!!v1) %>%\n    mutate(v=ifelse(!!v1==1,0,NA),\n           v=ifelse(!!v1==2,25, v),\n           v=ifelse(!!v1==3,50, v),\n           v=ifelse(!!v1==4,75, v),\n           v=ifelse(!!v1==5,100,v)) %>% \n    select(-!!v1)\n  names(dd) <- vt\n  return(dd)\n}\n\n\n#score for questions that have 4-point\nsc4 <- function(dt,vf,vt) {\n  v1 <- vf\n  v1 <- ensym(v1)\n  dd <- dt %>% select(!!v1) %>%\n    mutate(v=ifelse(!!v1==1,0,NA),\n           v=ifelse(!!v1==2,33.3, v),\n           v=ifelse(!!v1==3,66.7, v),\n           v=ifelse(!!v1==4,100,  v)) %>% \n    select(-!!v1)\n  names(dd) <- vt\n  return(dd)\n}\n\n#missing 16,18 for now\nscore_q48 <- function(df) {\n  #epilepsy impact\n  ei <- list(\n    lq = paste0(\"q\",c(25,26,28:34,36,47,48)),\n    lv = paste0(\"ei\",1:12)\n  )\n  r_ei <- map2(ei$lq,ei$lv,~sc5(dt=df,vf=.x,vt=.y)) %>% bind_cols()\n  \n  #memory/concentration\n  mc <- list(\n    # lq = paste0(\"q\",c(8,12:20)),\n    lq = paste0(\"q\",c(8,12:15,17,19,20)),\n    # lv = paste0(\"mc\",1:10)\n    lv = paste0(\"mc\",1:8)\n  ) \n  r_mc <- map2(mc$lq,mc$lv,~sc5(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #attitudes toward epilepsy\n  at <- list(\n    lq = paste0(\"q\",c(43:46)),\n    lv = paste0(\"at\",1:4)\n  ) \n  r_at <- map2(at$lq,at$lv,~sc5(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #physical functioning\n  pf <- list(\n    lq = paste0(\"q\",c(3:7)),\n    lv = paste0(\"pf\",1:5)\n  ) \n  r_pf <- map2(pf$lq,pf$lv,~sc5(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #stigma (4 category)\n  st <- list(\n    lq = paste0(\"q\",c(37:42)),\n    lv = paste0(\"st\",1:6)\n  ) \n  r_st <- map2(st$lq,st$lv,~sc4(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #social support\n  ss <- list(\n    lq = paste0(\"q\",c(21:24)),\n    lv = paste0(\"ss\",1:4)\n  ) \n  r_ss <- map2(ss$lq,ss$lv,~sc5(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #school behavior\n  sb <- list(\n    lq = paste0(\"q\",c(9:11,27)),\n    lv = paste0(\"sb\",1:4)\n  ) \n  r_sb <- map2(sb$lq,sb$lv,~sc5(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #health perceptions\n  hp <- list(\n    lq = paste0(\"q\",c(1,2,35)),\n    lv = paste0(\"hp\",1:3)\n  ) \n  r_hp <- map2(hp$lq,hp$lv,~sc5(dt=df,vf=.x,vt=.y))  %>% bind_cols()\n  \n  #summarise: what to do with missing item? currently averaging by domain\n  d1 <- bind_cols(r_ei,r_mc,r_at,r_pf,r_st,r_ss,r_sb,r_hp) %>% rowwise() %>% \n    mutate(sum_ei=mean(c_across(ei1:ei12),na.rm = T),\n           # sum_mc=mean(c_across(mc1:mc10),na.rm = T),\n           sum_mc=mean(c_across(mc1:mc8),na.rm = T),\n           sum_at=mean(c_across(at1:at4),na.rm = T),\n           sum_pf=mean(c_across(pf1:pf5),na.rm = T),\n           sum_st=mean(c_across(st1:st6),na.rm = T),\n           sum_ss=mean(c_across(ss1:ss4),na.rm = T),\n           sum_sb=mean(c_across(sb1:sb4),na.rm = T),\n           sum_hp=mean(c_across(hp1:hp3),na.rm = T)\n    ) %>% ungroup() %>% \n    mutate(overall=sum_ei*0.31+\n             sum_mc*0.17+\n             sum_at*0.09+\n             sum_pf*0.09+\n             sum_st*0.13+\n             sum_ss*0.02+\n             sum_sb*0.06+\n             sum_hp*0.12)\n}\n```\n:::\n\n\n### inclusion criteria\n\n#### VAS\n\nif Missed_fu is\n\n-   \"No\",\n-   \"No missed\",\n-   \"None\",\n-   \"N0\",\n-   \"Not missed\",\n-   \"NO\",\n-   \"No miss\",\n-   \"No messing\",\n-   \"No missen\",\n-   \"No missing\",\n-   \"0\",\n-   \"On time\" the response will be included.\n\nFor the NA(blank answers) and \"Visit Done\", we have no reasons to set them all as missing or not missing.\\\nSo I use the important indices(**follow_up_care_form_complete**, **confirmseize**, **weight_fu_v2**, **confirm_seizure_class_v2**) to distinguish whether they are actually missing or not.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfcf = fu  %>%\n  filter(redcap_repeat_instrument==\"follow_up_care_form\") %>% \n  mutate(incomplete=\n           ifelse(follow_up_care_form_complete<2 | is.na(confirmseize) | is.na(weight_fu_v2) | is.na(seizeclass),1,0)) %>%\n  mutate(missed = ifelse(missed_fu %in% c(\"No\", \"No missed\", \"None\", \"N0\", \"Not missed\", \"NO\", \"No miss\", \"No missing\", \"No messing\", \"No missen\", \"0\", \"On time\") | ((str_detect(missed_fu, \"Visit done\") | str_detect(missed_fu, \"Visit Done\") | is.na(missed_fu)) & incomplete == 0), 0, 1))\n\nfcf_c = fcf %>%\n  filter(missed == 0)\n\nfcf_c %>%\n  count(incomplete, missed_fu,sort = TRUE) %>%\n  left_join(fcf_c %>% count(missed_fu), by = c(\"missed_fu\"), suffix = c(\"_inclusive\", \"_in_and_ex\")) %>%\n  mutate(pct = percent(n_inclusive / n_in_and_ex)) %>%\n  kable(caption = \"incomplete = 0 means completing all the key questions\") %>%\n  kable_styling() %>%\n  scroll_box(height = \"400px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; \"><table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>incomplete = 0 means completing all the key questions</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> incomplete </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> missed_fu </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> n_inclusive </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> n_in_and_ex </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 14979 </td>\n   <td style=\"text-align:right;\"> 14979 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 269 </td>\n   <td style=\"text-align:right;\"> 269 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> No missed </td>\n   <td style=\"text-align:right;\"> 64 </td>\n   <td style=\"text-align:right;\"> 64 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> None </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> N0 </td>\n   <td style=\"text-align:right;\"> 39 </td>\n   <td style=\"text-align:right;\"> 39 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Not missed </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> NO </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, the CHW was sick. </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> No missing </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done the patient travelled for sallah break. </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. I was sick at the follow up time. </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient travelled. </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> No messing </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> No missen </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> On time </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done, Patient travelled with his mother </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done, the CHW put to bed a baby during the follow up period and was unable to bring the tablet for synching. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done, the CHW was nursing her sick infant child during the follow up period. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done, the CHW was sick and couldn't get the follow up on time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. I was sick. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. It is a phone visit, because the patient has moved to other part of the state and they couldn't get measuring scale for height, head and arm circumference. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. The parent couldn't be reached. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. The patient didn't come on the appointed date due to his mother's ilness. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. The patient travelled to Jigawa State. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. The patient travelled to another state in Nigeria which resulted in the delay for this follow up. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit Done. The patient's mother was not around. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done but the child lost wight becouse she have fever and abd pain send to  Dr to see at Hospital </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done child have fever send Dr see </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done no seizures but the child is very slim due to lack of food my the mother </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done the child didn't not have seizures but her condition is not good and wight is lost and no fever or diarrhoes  l send them to see  a Dr that  Hospital </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, The CHW was sick during the follow up period. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, but it was late because the patient travelled to Funtua LGA in Katsina State where there is not network communication. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, the CHW was nursing her child during the follow up period. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, the patient travelled and are now back home. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, the patient travelled but are now back home. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done, the patient travelled for sallah break </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. At first, the father said they travel for wedding, and they will spend 2 weeks, so after 2 weeks i call there number is not going so i desided to pay them a visit, today 6 oct 2021, yet the mother said she cannot go for BP today. she said she will make it next week. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. I was ill during the time of the visit, i could not do it on time! </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. I was sick - therefore, the visit was delayed. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. I was sick during the appointment date. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. I was sick during the follow up visif,so i could not do it on time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. I was sick during the follow up visit, that is why the follow up was delay. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. It was delayed because the patient travelled. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. It was delayed because they relocated and their line was unreachable. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. It was delayed due to the fact that the father who normally brings the child to the followup was sick. Moreover, the CHW figured financial constraints with the father and intended to give a helping hand but they couldn't be reached via phone afterwards until 3 weeks ago. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. Patient couldn't be reached. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. Patient relocated but we tracked them and they are able to come for both blinded physician and CHW visits today. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. She travelled at follow up time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The CHW lost contact with the parents of the child until last Monday. As such, the visit is measured late. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The CHW regains contact with the mother of the child after over 3 months of tireless tracking. The mother travelled to Niger Republic. The notification of the journey to the CHW failed. She told the CHW that, the child has been on the AED while they were away (abroad). </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The CHW was sick at the time of the visit. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The child had diarrhoea which made him loose 3kg of weight. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The child had lost in weight due to malaria fever. But she has recovered. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The delay was due to the fact their phone was unreachable. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The follow up was done within the window. The CHW lost her father and was in mourning. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The increased in previous weight occurs due to problem of weighing scale used before receiving the new one for the study. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The mother can not afford to buy the drug any more due to financial constraints, and the father is not giving any help.That is why the mother is trying to switch to traditional medicine but unfortunately the traditional healer deceived them and collect their money without treating her and ran away. This is what her Aunty told me the time I went to the house where they used to reside if they are coming for follow up and other schedules, because I couldn't reach them on phone.\n\nI have collected their full current residential address  for tracing. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The mother was sick. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The parent relocated to Yobe state. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The parent's phone couldn't be reached. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The parents relocated to a new location without notice and their contact couldn't be reached until last Thursday 2nd September 2021. Therefore, the visit was delayed. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient is currently living with her grandmother in Abuja. She's returning to Kano only when secondary schools closes for sessional holidays. As such, the followup visit was delayed. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient traveled at the appointment date. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient travelled since before Sallah break. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient travelled to their Village. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient travelled. Later, I was sick and admitted into hospital. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The patient was missing since mid June 2021. Parents were lucky to find the child end of August 2021. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The reason it was delayed is because the patient travelled. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. The visit wasn't done at appointment date because his mother was sick at the time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They missed appointment because of transportion. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They patient travelled outside Kano. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They temporarily relocated to Lagos. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They travel at the appointment date. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They traveled at the appointment date. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They traveled. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They travelled at the follow up time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They travelled to Bauchi state at that time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done. They were not around at that time. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Visit done.The patient was not available on the exact follow up day. </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n\n```{.r .cell-code}\nfcf_c = fcf_c %>% select(-gender) %>% left_join(gender, by = c(\"record_id\", \"study_arm\"))\n```\n:::\n\n\n#### QOLIE\n\n**Source**\n\n1.  from both Screening and Follow up visits;\n\n2.  including both QOLIE-31 and QOLIE-AD-48.\n\n**Logic for selecting same-day QOLIE records**\n\nFor every participant, if there exists 2 QOLIE records on the same day,\n\n1.  choose the one with type(QOLIE-31/QOLIE-AD-48) more eligible for the age(11-17 use QOLIE-AD-48, \\>18 use QOLIE-31);\n\n2.  if the same QOLIE type, choose the one with less missing domain and less missing items;\n\n3.  if still the same, choose the one with bigger *instance*.\n\n**Logic for i-th QOLIE**\n\nFor every participant,\n\n1.  the baseline date is obtained from *date_consent_screen* or *dataconsentenroll*, choosing one based on *ev0*;\n\n2.  0th QOLIE(**first**): the first occurence of QOLIE records, no matter whether the date is on or before or after the baseline date, and no matter whether the record is from Screening or Follow up Visits, except from one case: the date is after \"2022-01-01\";\n\n3.  3rd QOLIE(**last**): the last time of QOLIE records and the date is after \"2022-01-01\". For those who have only one time QOLIE record, if the date is after \"2022-01-01\", the record will be labeled as the 3-rd, as the participants are only old enough(\\>11) for the last time of visits(maybe we can compare their previous VAS score and this time of QOLIE);\n\n4.  1st or 2nd: the ones between the 0th and 3rd. For participants with 4 times of QOLIE and participants with 2 times of after-\"2022-01-01\" QOLIE, the 2nd will be filled -- they could also be dropped as they are not so consistent with the schedule;\n\n5.  For the records with \"NA\" dates, the order will depend on the *instance*. I prefer to put them on the 2nd, as they might be dropped as the data includes too much noises.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq31_fu = fu %>% filter(redcap_repeat_instrument==\"qolie_31_17_v0_m2_m24\") %>% \n  select(record_id, study_arm, starts_with(\"red\"), contains(\"qolie31\"), complete = qolie_31_17_v0_m2_m24_complete) %>% \n  rename_at(vars(starts_with(\"qolie31_q\")),~str_remove(.,\"qolie31_\")) %>%\n  mutate(form = \"Follow Up Visits\")\n\nq31_scr = bs %>% filter(qolie_31_17_v0_complete == \"2\") %>% \n  select(record_id = unique_id, study_arm, starts_with(\"red\"), contains(\"qolie31\"), complete = qolie_31_17_v0_complete,-redcap_event_name) %>% \n  rename_at(vars(starts_with(\"qolie31_q\")),~str_remove(.,\"qolie31_\")) %>%\n  mutate(form = \"Screening\")\n\nq31 = rbind.data.frame(q31_scr, q31_fu)\n\nq48_fu <- fu %>% filter(redcap_repeat_instrument==\"qolie_48_1117_v0_m2_m24\") %>% \n  select(record_id,study_arm,starts_with(\"red\"),contains(\"qolie48\"), complete = qolie_48_1117_v0_m2_m24_complete) %>% \n  mutate(form = \"Follow Up Visits\")\n\nq48_scr = bs %>% filter(qolie_48_1117_v0_complete == \"2\") %>% \n  select(record_id = unique_id, study_arm, starts_with(\"red\"), contains(\"qolie48\"), complete = qolie_48_1117_v0_complete,-redcap_event_name) %>% \n  mutate(form = \"Screening\")\n\nq48 = rbind.data.frame(q48_scr, q48_fu)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# QOLIE-31\nr31 <-  score_q31(q31) \n\nr31x <- r31 %>% rowwise() %>% \n  mutate(miss_item=sum(is.na(c_across(sw1:sf5))),\n         miss_domain=sum(is.na(c_across(starts_with(\"sum\")))))\n\n# QOLIE-AD-48\nxwalk <- readxl::read_xlsx(\"~/Documents/GitHub/MarkovDA/data/qolie48_xwalk.xlsx\")\n\nvv = data.frame(vn_redcap=names(q48),x=1:length(names(q48)),stringsAsFactors = F) %>%\n  left_join(xwalk, by = \"vn_redcap\") \n# there will be NA\n\n#rename survey question to align with original questionnaire\nfor(i in 1:nrow(vv)) {\n  if (is.na(vv$vn_Cramer[i])) {\n    vv$vn_Cramer[i] = vv$vn_redcap[i]\n  }\n}\n\nnames(q48) = vv$vn_Cramer\n\nr48p <- score_q48(q48) \nr48 <- bind_cols(q48,r48p)\n\nr48x <- r48 %>% rowwise() %>% \n  mutate(miss_item=sum(is.na(c_across(ei1:hp3))),\n         miss_domain=sum(is.na(c_across(starts_with(\"sum\")))))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nallqolie = r48x %>% mutate(type = \"QOLIE-AD-48\") %>%\n  select(record_id, study_arm, dateqolie = dateqolie48, score = overall, type, instance = redcap_repeat_instance, miss_item, miss_domain) %>% \n  full_join(r31x %>% mutate(type = \"QOLIE-31\") %>% \n              select(record_id, study_arm, dateqolie = dateqolie31, score = overall, type, instance = redcap_repeat_instance, miss_item, miss_domain)) %>% \n  left_join(basedate %>% select(-age), by = c(\"record_id\", \"study_arm\")) %>% \n  filter(!is.nan(score)) \n\nallqolie = allqolie %>% count(record_id, sort = TRUE) %>% rename(qolietimes = n) %>% left_join(allqolie) %>%\n  mutate(age = as.numeric(dateqolie - bd)/365.25, eligibility = ifelse(age > 17, \"QOLIE-31\", ifelse(age < 11, \"VAS\", \"QOLIE-AD-48\"))) %>%\n  arrange(desc(qolietimes), record_id, dateqolie, desc(miss_domain), desc(miss_item), instance)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## repeat -- same day twice\nrepeated = allqolie %>% group_by(record_id) %>% count(dateqolie) %>% filter(n > 1) %>% rename(repeattime = n)\n# All of ns are 2. \n\nrepeatqolie = allqolie %>% left_join(repeated) %>% filter(repeattime == 2) %>% mutate(remove = 0)\n\nfor (i in seq(1,nrow(repeatqolie),2)){\n  ## first -- type\n  if (repeatqolie[i,\"type\"] != repeatqolie[i+1,\"type\"]){\n    if (repeatqolie[i,\"type\"] == repeatqolie[i, \"eligibility\"]){\n      repeatqolie[i+1, \"remove\"] = 1\n    } else {\n      repeatqolie[i, \"remove\"] = 1\n    }\n  } else {\n    ## then -- miss_item\n    if (repeatqolie[i,\"miss_item\"] != repeatqolie[i+1, \"miss_item\"]) {\n      max_item = max(repeatqolie[i,\"miss_item\"], repeatqolie[i+1,\"miss_item\"])\n      if (repeatqolie[i,\"miss_item\"] == max_item) {\n        repeatqolie[i,\"remove\"] = 1\n      } else {\n        repeatqolie[i+1,\"remove\"] = 1\n      }\n    } else {\n      ## asc(instance) so smaller instance will be removed\n      repeatqolie[i,\"remove\"] = 1\n    }\n  }\n}\n\nallqolie_c = allqolie %>% left_join(repeatqolie) %>% filter(remove == 0 | is.na(remove)) %>% select(-repeattime, -remove, -qolietimes)\nallqolie_c = allqolie_c %>% count(record_id, sort = TRUE) %>% rename(qolietimes = n) %>% left_join(allqolie_c)\n\n## order = 0\norder0 = allqolie_c %>% filter(!is.na(dateqolie)) %>% group_by(record_id) %>% filter(dateqolie == min(dateqolie)) %>%\n  ungroup() %>% filter(dateqolie < \"2022-01-01\") %>% mutate(order = 0)\n\n## order = 3\norder3 = allqolie_c %>% filter(!is.na(dateqolie)) %>% group_by(record_id) %>% filter(dateqolie == max(dateqolie)) %>% \n  ungroup() %>% filter(dateqolie >= \"2022-01-01\") %>% mutate(order = 3)\n## the first time but > 2022-01-01 -- if only once but 2022\n\n## order = 2\norder2_1 = allqolie_c %>% group_by(record_id) %>% filter(dateqolie == min(dateqolie)) %>% \n  ungroup() %>% filter(dateqolie >= \"2022-01-01\") %>% filter(qolietimes != 1) %>% mutate(order = 2)\n\n#allqolie_c %>% filter(qolietimes == 1 & dateqolie >= \"2022-01-01\") \n\n## two times both > 2022-01-01\norder2_2 = allqolie_c %>% filter(dateqolie >= \"2022-01-01\") %>% group_by(record_id) %>% filter(dateqolie < max(dateqolie)) %>%\n  mutate(order = 2)\n# date is NA\norder2_3 = allqolie_c %>% filter(is.na(dateqolie)) %>% mutate(order = 2)\n## 4 times\norder2_4 = allqolie_c %>% filter(qolietimes == 4) %>% group_by(record_id) %>% filter(dateqolie != min(dateqolie) & dateqolie != max(dateqolie) & (difftime(dateqolie, min(dateqolie), units= \"days\") >= 80 | difftime(dateqolie, min(dateqolie), units= \"days\") <= 40)) %>%\n  mutate(order = 2)\n\norder2_5 = allqolie_c %>% filter(qolietimes == 4) %>% group_by(record_id) %>% filter(dateqolie != min(dateqolie) & dateqolie != max(dateqolie) & (difftime(dateqolie, min(dateqolie), units= \"days\") >= 42 & difftime(dateqolie, min(dateqolie), units= \"days\") <= 70)) %>% \n  filter((record_id == \"PHC---134-90-2020-08-12 12:16\" & dateqolie == \"2020-10-02\") | (record_id == \"PHC---134-90-2020-08-17 21:47\" & dateqolie == \"2020-10-02\") | (record_id == \"PHC---141-119-2020-07-01 11:26\" & dateqolie == \"2020-09-06\") | (record_id == \"PHC--103--69-2020-11-23 10:26\" & dateqolie == \"2021-01-18\")) %>%\n  mutate(order = 2)\n\n## order = 1\norder2_6 = allqolie_c %>% anti_join(order0) %>% anti_join(order3) %>% anti_join(order2_1) %>% \n  anti_join(order2_2) %>% anti_join(order2_3) %>% anti_join(order2_4) %>% anti_join(order2_5) %>% count(record_id) %>% filter(n>1) %>% left_join(allqolie_c) %>%\n  filter((record_id == \"PHC---132-50-2020-06-26 10:47\" & dateqolie == \"2021-08-24\") | (record_id == \"PHC---132-50-2020-12-16 11:28\" & dateqolie == \"2020-12-23\") | (record_id == \"PHC---133-32-2020-08-10 10:09\" & dateqolie == \"2020-08-17\") | (record_id == \"PHC---133-44-2020-08-19 12:16\" & dateqolie == \"2020-10-30\") | (record_id == \"PHC--103--77-2020-11-19 04:30\" & dateqolie == \"2020-11-26\")) %>% mutate(order = 2)\n\norder2 = order2_1 %>% \n  full_join(order2_2) %>% full_join(order2_3) %>% full_join(order2_4) %>% full_join(order2_5) %>% full_join(order2_6) %>% select(-n)\n\n\norder1 = allqolie_c %>% anti_join(order0) %>% anti_join(order3) %>% anti_join(order2) %>% mutate(order = 1)\n\n## bind\nallq = bind_rows(order0, order1, order2, order3)\n\n# save(fu, bs, allq, fcf, fcf_c, gender, fudw, gender, location, dob, repeated, allqolie, order2, file = \"with-drop-out.rda\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nallq = allq %>% \n  anti_join(fu %>% filter(reason != 1) %>% distinct(study_arm,record_id))\n\nfcf_c = fcf_c %>% anti_join(fu %>% filter(reason != 1) %>% distinct(study_arm,record_id))\n\n# save(fu, bs, allq, fcf, fcf_c, gender, fudw, gender, location, dob, repeated, allqolie, order2, file = \"data/without-drop-out.rda\")\n```\n:::\n\n\n# Analysis and Result Briefs\n\nIf you'd like to see the results for participants excluding drop-outs, load the \"without-drop-out.rda\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load(\"data/with-drop-out.rda\")\n# load(\"without-drop-out.rda\")\n```\n:::\n\n\n## QOLIE(QOLIE-31 & QOLIE-AD-48)\n\n### the Inclusion Criteria of QOLIE records\n\n**Source**\n\n1.  from both Screening and Follow up visits;\n\n2.  including both QOLIE-31 and QOLIE-AD-48.\n\n**Logic for selecting same-day QOLIE records**\n\nFor every participant, if there exists 2 QOLIE records on the same day,\n\n1.  choose the one with type(QOLIE-31/QOLIE-AD-48) more eligible for the age(11-17 use QOLIE-AD-48, \\>18 use QOLIE-31);\n\n2.  if the same QOLIE type, choose the one with less missing domain and less missing items;\n\n3.  if still the same, choose the one with bigger *instance*.\n\nThere are 75 participants have 2 or more QOLIE records on the same day, the max times is 2.\n\n**Logic for i-th QOLIE**\n\nFor every participant,\n\n1.  the baseline date is obtained from *date_consent_screen* or *dataconsentenroll*, choosing one based on *ev0*;\n\n2.  0th QOLIE(**first**): the first occurence of QOLIE records, no matter whether the date is on or **before** or **after** the baseline date, and no matter whether the record is from Screening or Follow up Visits, except from one case: the date is after \"2022-01-01\"; -- There are 181 records of 0th order with the date later than the baseline date.\n\n3.  3rd QOLIE(**last**): the last time of QOLIE records and the date is after \"2022-01-01\". For those who have only one time QOLIE record, if the date is after \"2022-01-01\", the record will be labeled as the 3-rd, as the participants are only old enough(\\>11) for the last time of visits(maybe we can compare their previous VAS score and this time of QOLIE);\n\n4.  1st or 2nd: the ones between the 0th and 3rd. For participants with 4 times of QOLIE and participants with 2 times of after-\"2022-01-01\" QOLIE, the 2nd will be filled -- they could also be dropped as they are not so consistent with the schedule;\n\n5.  For the 6 records with \"NA\" dates, the order will depend on the *instance*. I prefer to put them on the 2nd, as they might be dropped when building models as the data includes too much noises.\n\n#### Complete Rate of the instruments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>% \n  mutate(base = ifelse(type == 'QOLIE-AD-48', 47, 31), miss_item_p = (base - miss_item) / base, miss_item_pct = ifelse(miss_item_p == 1, '100%', ifelse(miss_item_p < 1 & miss_item_p >= 0.9, '90% - 99%', ifelse(miss_item_p < 0.9 & miss_item_p >= 0.8, '80% - 89%', 'below 80%')))) %>%\n  count(study_arm, miss_item_pct) %>%\n  group_by(study_arm) %>%\n  mutate(pct = percent(n / sum(n))) %>%\n  arrange(study_arm, desc(n)) %>%\n  ungroup() %>%\n  select(-study_arm) %>%\n  rename(complete_rate = miss_item_pct) %>%\n  kable(caption = \"Complete Rates of QOLIE\") %>%\n  kable_styling(full_width = F) %>%\n  pack_rows(\"EUC\",1,4) %>%\n  pack_rows(\"TSC\",5,8) %>%\n  scroll_box()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 5px; \"><table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Complete Rates of QOLIE</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> complete_rate </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>EUC</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 100% </td>\n   <td style=\"text-align:right;\"> 699 </td>\n   <td style=\"text-align:left;\"> 69.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 90% - 99% </td>\n   <td style=\"text-align:right;\"> 222 </td>\n   <td style=\"text-align:left;\"> 22.0% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 80% - 89% </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:left;\"> 6.1% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> below 80% </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:left;\"> 2.5% </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>TSC</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 100% </td>\n   <td style=\"text-align:right;\"> 838 </td>\n   <td style=\"text-align:left;\"> 74.3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 90% - 99% </td>\n   <td style=\"text-align:right;\"> 224 </td>\n   <td style=\"text-align:left;\"> 19.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 80% - 89% </td>\n   <td style=\"text-align:right;\"> 59 </td>\n   <td style=\"text-align:left;\"> 5.2% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> below 80% </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> 0.6% </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n\n```{.r .cell-code}\nggplot(data=allq, aes(x=miss_item)) + \n  geom_histogram(binwidth = 1) +\n  stat_bin(binwidth=1, geom=\"text\", aes(label=..count..), vjust = -0.25) +\n  facet_grid(type~study_arm) +\n  theme_minimal() +\n  xlab(\"Number of missing item\") + ylab(\"Freq\") + ylim(c(0, 800)) + \n  ggtitle(\"Missing items among the questions in QOLIE\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/miss-item-1.png){width=672}\n:::\n\n```{.r .cell-code}\nallq = allq %>% mutate(base = ifelse(type == 'QOLIE-AD-48', 47, 31), miss_item_p = (base - miss_item) / base) %>%\n  filter(miss_item_p >= 0.8) %>% select(-base, -miss_item_p)\n```\n:::\n\n\nThen based on the completion rate, we'll delete the cases with completion rate lower than 80%.\n\n### Missing Rate for QOLIE\n\n#### Had QOLIE records / Should have QOLIE records\n\nNumber of Participants with QOLIE records: 813\n\nNumber of Participants being over 11 at lease once during visits: 873\n\nThere are 46 participants not old enough to use QOLIE (at least once), but indeed having QOLIE records.\n\nNumber of Participants eligible to have and indeed having QOLIE records: 786, rate is 90%\n\n#### How many times of QOLIE the participants have?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>% count(record_id) %>% \n  rename(times_of_qolie = n) %>% \n  count(times_of_qolie) %>%\n  kable(caption = \"times of QOLIE\") %>%\n  kable_styling(full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>times of QOLIE</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> times_of_qolie </th>\n   <th style=\"text-align:right;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 154 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 567 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ncat(\"order 0th is the first one, order 3th is the last one (2022) \")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\norder 0th is the first one, order 3th is the last one (2022) \n```\n:::\n\n```{.r .cell-code}\nallq %>% group_by(study_arm, order) %>% \n  summarise(n_records = n(), mean_score = mean(score), sd_score = sd(score)) %>%\n  group_by(study_arm) %>%\n  mutate(pct_by_arm = percent(n_records / sum(n_records))) %>% \n  ungroup() %>%\n  select(order, n_records, pct_by_arm, mean_score, sd_score) %>%\n  kable(caption=\"QOLIE records by order\") %>% \n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\")) %>%\n  pack_rows(\"EUC\",1,4) %>%\n  pack_rows(\"TSC\",5,8)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>QOLIE records by order</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> order </th>\n   <th style=\"text-align:right;\"> n_records </th>\n   <th style=\"text-align:left;\"> pct_by_arm </th>\n   <th style=\"text-align:right;\"> mean_score </th>\n   <th style=\"text-align:right;\"> sd_score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>EUC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:right;\"> 314 </td>\n   <td style=\"text-align:left;\"> 32.0% </td>\n   <td style=\"text-align:right;\"> 48.95061 </td>\n   <td style=\"text-align:right;\"> 16.32521 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:right;\"> 289 </td>\n   <td style=\"text-align:left;\"> 29.4% </td>\n   <td style=\"text-align:right;\"> 50.63552 </td>\n   <td style=\"text-align:right;\"> 14.08038 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> 1.9% </td>\n   <td style=\"text-align:right;\"> 40.82569 </td>\n   <td style=\"text-align:right;\"> 17.30808 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:left;\"> 36.7% </td>\n   <td style=\"text-align:right;\"> 53.38654 </td>\n   <td style=\"text-align:right;\"> 14.67627 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>TSC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:right;\"> 357 </td>\n   <td style=\"text-align:left;\"> 31.8% </td>\n   <td style=\"text-align:right;\"> 48.39177 </td>\n   <td style=\"text-align:right;\"> 15.64808 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:right;\"> 329 </td>\n   <td style=\"text-align:left;\"> 29.3% </td>\n   <td style=\"text-align:right;\"> 50.14836 </td>\n   <td style=\"text-align:right;\"> 14.75667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> 1.7% </td>\n   <td style=\"text-align:right;\"> 46.27617 </td>\n   <td style=\"text-align:right;\"> 15.75473 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:right;\"> 416 </td>\n   <td style=\"text-align:left;\"> 37.1% </td>\n   <td style=\"text-align:right;\"> 54.85074 </td>\n   <td style=\"text-align:right;\"> 13.93200 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nallq %>% group_by(study_arm, order, type) %>% \n  summarise(n_records = n(), mean_score = mean(score), sd_score = sd(score)) %>%\n  group_by(study_arm) %>%\n  mutate(pct_by_arm = percent(n_records / sum(n_records))) %>% \n  ungroup() %>%\n  select(order, type, n_records, pct_by_arm, mean_score, sd_score) %>%\n  kable(caption=\"QOLIE records by order\") %>% \n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\")) %>%\n  pack_rows(\"EUC\",1,8) %>%\n  pack_rows(\"TSC\",9,16)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>QOLIE records by order</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> order </th>\n   <th style=\"text-align:left;\"> type </th>\n   <th style=\"text-align:right;\"> n_records </th>\n   <th style=\"text-align:left;\"> pct_by_arm </th>\n   <th style=\"text-align:right;\"> mean_score </th>\n   <th style=\"text-align:right;\"> sd_score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"8\"><td colspan=\"6\" style=\"border-bottom: 1px solid;\"><strong>EUC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 0.31% </td>\n   <td style=\"text-align:right;\"> 56.13713 </td>\n   <td style=\"text-align:right;\"> 8.209630 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 311 </td>\n   <td style=\"text-align:left;\"> 31.67% </td>\n   <td style=\"text-align:right;\"> 48.88129 </td>\n   <td style=\"text-align:right;\"> 16.375356 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> 1.32% </td>\n   <td style=\"text-align:right;\"> 53.96729 </td>\n   <td style=\"text-align:right;\"> 14.147086 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 276 </td>\n   <td style=\"text-align:left;\"> 28.11% </td>\n   <td style=\"text-align:right;\"> 50.47859 </td>\n   <td style=\"text-align:right;\"> 14.083550 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 0.41% </td>\n   <td style=\"text-align:right;\"> 42.93823 </td>\n   <td style=\"text-align:right;\"> 7.414770 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:left;\"> 1.53% </td>\n   <td style=\"text-align:right;\"> 40.26235 </td>\n   <td style=\"text-align:right;\"> 19.281196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 106 </td>\n   <td style=\"text-align:left;\"> 10.79% </td>\n   <td style=\"text-align:right;\"> 57.38363 </td>\n   <td style=\"text-align:right;\"> 13.691124 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 254 </td>\n   <td style=\"text-align:left;\"> 25.87% </td>\n   <td style=\"text-align:right;\"> 51.71847 </td>\n   <td style=\"text-align:right;\"> 14.776838 </td>\n  </tr>\n  <tr grouplength=\"8\"><td colspan=\"6\" style=\"border-bottom: 1px solid;\"><strong>TSC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> 0.535% </td>\n   <td style=\"text-align:right;\"> 47.05317 </td>\n   <td style=\"text-align:right;\"> 8.083108 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 351 </td>\n   <td style=\"text-align:left;\"> 31.311% </td>\n   <td style=\"text-align:right;\"> 48.41465 </td>\n   <td style=\"text-align:right;\"> 15.751050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:left;\"> 0.981% </td>\n   <td style=\"text-align:right;\"> 57.15158 </td>\n   <td style=\"text-align:right;\"> 9.376176 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 318 </td>\n   <td style=\"text-align:left;\"> 28.368% </td>\n   <td style=\"text-align:right;\"> 49.90611 </td>\n   <td style=\"text-align:right;\"> 14.858722 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> 0.446% </td>\n   <td style=\"text-align:right;\"> 57.10524 </td>\n   <td style=\"text-align:right;\"> 18.703434 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:left;\"> 1.249% </td>\n   <td style=\"text-align:right;\"> 42.40865 </td>\n   <td style=\"text-align:right;\"> 13.222303 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:left;\"> QOLIE-31 </td>\n   <td style=\"text-align:right;\"> 124 </td>\n   <td style=\"text-align:left;\"> 11.062% </td>\n   <td style=\"text-align:right;\"> 59.26109 </td>\n   <td style=\"text-align:right;\"> 11.612683 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:left;\"> QOLIE-AD-48 </td>\n   <td style=\"text-align:right;\"> 292 </td>\n   <td style=\"text-align:left;\"> 26.048% </td>\n   <td style=\"text-align:right;\"> 52.97785 </td>\n   <td style=\"text-align:right;\"> 14.422254 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nTotally, there are 241 participants having at least one time of QOLIE-31 -- totally 272 records.\n\n#### Time distribution for QOLIE times\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>%\n  group_by(order) %>%\n  ggplot(aes(x=dateqolie)) + \n  geom_histogram(bins = 50) +\n  facet_grid(order~.) +\n  theme_minimal() +\n  xlab(\"QOLIE\") + ylab(\"Freq\") +\n  ggtitle(\"Histogram of QOLIE dates\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/qolie-dates-1.png){width=672}\n:::\n:::\n\n\n### Demographic of QOLIE users\n\n#### Gender\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>% distinct(record_id) %>% left_join(gender) %>%\n  mutate(gender=factor(gender,levels=1:2,labels=c(\"Female\",\"Male\"))) %>%\n  count(study_arm, gender) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable() %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> gender </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 136 </td>\n   <td style=\"text-align:left;\"> 36% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 245 </td>\n   <td style=\"text-align:left;\"> 64% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 159 </td>\n   <td style=\"text-align:left;\"> 37% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 273 </td>\n   <td style=\"text-align:left;\"> 63% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### City\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>% distinct(record_id) %>% left_join(location) %>%\n  count(study_arm, city) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable() %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> city </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:left;\"> 23.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 178 </td>\n   <td style=\"text-align:left;\"> 46.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 114 </td>\n   <td style=\"text-align:left;\"> 29.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 97 </td>\n   <td style=\"text-align:left;\"> 22.5% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 229 </td>\n   <td style=\"text-align:left;\"> 53.0% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 106 </td>\n   <td style=\"text-align:left;\"> 24.5% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Age and Age eligibility\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>% \n  ggplot(aes(x = age)) + \n  geom_histogram(binwidth = 1) +\n  facet_grid(study_arm ~ order) +\n  theme_minimal() +\n  xlab(\"Age\") + ylab(\"Freq\") +\n  ggtitle(\"Age Distribution for QOLIE users\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/age-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(allq %>% mutate(elig = factor(ifelse(type == eligibility, \"Correct\", \"Ineligible\"))), aes(x = age, y = score, color = factor(order), shape = elig)) +\n  geom_point(position = \"dodge\", alpha = 0.8) +\n  scale_color_brewer(palette = \"Spectral\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/age-2.png){width=672}\n:::\n:::\n\n\n### Distribution of QOLIE Scores\n\nAs the 2th records include lots of noises and have a small sample for both 2 arms, we may exclude it in the later analysis. The other 3 parts show a normal distribution shape and a small increasing tendency for the average score.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallq %>% group_by(study_arm, order) %>% \n  summarise(n_records = n(), mean_score = mean(score), sd_score = sd(score)) %>%\n  group_by(study_arm) %>%\n  mutate(pct_by_arm = percent(n_records / sum(n_records))) %>% \n  ungroup() %>%\n  select(order, n_records, pct_by_arm, mean_score, sd_score) %>%\n  kable(caption=\"QOLIE records by order\") %>% \n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\")) %>%\n  pack_rows(\"EUC\",1,4) %>%\n  pack_rows(\"TSC\",5,8)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>QOLIE records by order</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> order </th>\n   <th style=\"text-align:right;\"> n_records </th>\n   <th style=\"text-align:left;\"> pct_by_arm </th>\n   <th style=\"text-align:right;\"> mean_score </th>\n   <th style=\"text-align:right;\"> sd_score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>EUC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:right;\"> 314 </td>\n   <td style=\"text-align:left;\"> 32.0% </td>\n   <td style=\"text-align:right;\"> 48.95061 </td>\n   <td style=\"text-align:right;\"> 16.32521 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:right;\"> 289 </td>\n   <td style=\"text-align:left;\"> 29.4% </td>\n   <td style=\"text-align:right;\"> 50.63552 </td>\n   <td style=\"text-align:right;\"> 14.08038 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> 1.9% </td>\n   <td style=\"text-align:right;\"> 40.82569 </td>\n   <td style=\"text-align:right;\"> 17.30808 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:left;\"> 36.7% </td>\n   <td style=\"text-align:right;\"> 53.38654 </td>\n   <td style=\"text-align:right;\"> 14.67627 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>TSC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0 </td>\n   <td style=\"text-align:right;\"> 357 </td>\n   <td style=\"text-align:left;\"> 31.8% </td>\n   <td style=\"text-align:right;\"> 48.39177 </td>\n   <td style=\"text-align:right;\"> 15.64808 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:right;\"> 329 </td>\n   <td style=\"text-align:left;\"> 29.3% </td>\n   <td style=\"text-align:right;\"> 50.14836 </td>\n   <td style=\"text-align:right;\"> 14.75667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> 1.7% </td>\n   <td style=\"text-align:right;\"> 46.27617 </td>\n   <td style=\"text-align:right;\"> 15.75473 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:right;\"> 416 </td>\n   <td style=\"text-align:left;\"> 37.1% </td>\n   <td style=\"text-align:right;\"> 54.85074 </td>\n   <td style=\"text-align:right;\"> 13.93200 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nallq %>%\n  ggplot(aes(x=score, y=..density..)) + \n  geom_histogram(binwidth = 2) +\n  geom_density() + \n  facet_grid(study_arm ~ order) +\n  theme_minimal() +\n  xlab(\"QOLIE Scores\") + ylab(\"Density\") +\n  ggtitle(\"Density Distribution of valid QOLIE scores\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/qolie-scores-1.png){width=672}\n:::\n:::\n\n\n### Exploratory Hypothesis Testing\n\nBecause there are not enough samples for order == 2 which also includes some noises, I excluded the 2th order in the analysis. The inclusion criteria is: participants with at least 0th(the regarded \"first\") and 3th(the regarded \"last\") QOLIE records.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqinfo = allq %>% filter(order == 0) %>% select(record_id) %>% inner_join(allq %>% filter(order == 3), by = \"record_id\") %>% select(record_id) %>% left_join(allq) %>% filter(order != 2) %>% left_join(gender) %>% left_join(location)\n# %>% filter(type = eligibility)\n\nt.test(\n  score ~ factor(study_arm),\n  data = qinfo,\n  var.equal = TRUE\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  score by factor(study_arm)\nt = -0.43916, df = 1863, p-value = 0.6606\nalternative hypothesis: true difference in means between group EUC and group TSC is not equal to 0\n95 percent confidence interval:\n -1.662510  1.054189\nsample estimates:\nmean in group EUC mean in group TSC \n         50.97605          51.28022 \n```\n:::\n:::\n\n\nThere's no difference between 2 arms among all times.\n\nThe *study arm*, *order*, *gender*, and *city* variables are all categorical variables(like dummy variables) without numeric meaning, so we use factor here. *Age* is numeric.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(score ~ factor(study_arm)*factor(order), qinfo))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = score ~ factor(study_arm) * factor(order), data = qinfo)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-55.145  -8.233   0.945   9.421  42.452 \n\nCoefficients:\n                                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                          48.6811     0.8601  56.600  < 2e-16 ***\nfactor(study_arm)TSC                 -0.2161     1.1728  -0.184 0.853857    \nfactor(order)1                        2.2354     1.2349   1.810 0.070442 .  \nfactor(order)3                        4.6461     1.2163   3.820 0.000138 ***\nfactor(study_arm)TSC:factor(order)1  -0.5351     1.6840  -0.318 0.750709    \nfactor(study_arm)TSC:factor(order)3   2.0338     1.6585   1.226 0.220254    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.72 on 1859 degrees of freedom\nMultiple R-squared:  0.02752,\tAdjusted R-squared:  0.0249 \nF-statistic: 10.52 on 5 and 1859 DF,  p-value: 5.62e-10\n```\n:::\n\n```{.r .cell-code}\ninteraction.plot(x.factor = qinfo$order, #x-axis variable\n                 trace.factor = qinfo$study_arm, #variable for lines\n                 response = qinfo$score, #y-axis variable\n                 fun = mean, #metric to plot\n                 ylab = \"QOLIE Score (marginal mean)\",\n                 xlab = \"Order of QOLIE\",\n                 col = c(\"pink\", \"blue\"),\n                 lty = 1, #line type\n                 lwd = 2, #line width\n                 trace.label = \"Study Arm\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/lm0-1.png){width=672}\n:::\n:::\n\n\nWhen trying to explain the group difference among the times and the arms,\n\nThe intercept is the QOLIE score of EUC arm on the 0th order.\n\nFor the 0th records, the difference between 2 arms is not significant.\n\nthe main effect of order is kind of significantly(1th over 0th: p \\< 0.1, marginal significant; 3th over 0th, p \\< 0.05, siginificant) positive -- as time goes by (**may caused by more treatment, changes in life, age grows**), the QOLIE score improves.\n\nNot find any evidence that the TSC has a better effect than EUC on every visit.\n\nThe lm formula creates several dummy variables:\n\n*TSC*, for TSC arm is 1 and EUC arm is 0;\n\n*order1* and *order3*, for 0th having both 2 are 0, 1th for only order1 = 1 and 3th for only order3 = 1.\n\n\n$$QOLIE = 48.6810946 + -0.2160521 * TSC + 2.2353547 * order_1 + 4.6460678 * order_3 \\\\ + -0.5350992 * TSC * order_1 + 2.0338043 * TSC * order_3 $$\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(score ~ factor(study_arm)*factor(order) + age, qinfo))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = score ~ factor(study_arm) * factor(order) + age, \n    data = qinfo)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-54.982  -8.212   0.958   9.256  42.552 \n\nCoefficients:\n                                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                          37.1729     2.7219  13.657  < 2e-16 ***\nfactor(study_arm)TSC                 -0.1890     1.1669  -0.162   0.8713    \nfactor(order)1                        2.0521     1.2294   1.669   0.0953 .  \nfactor(order)3                        3.1645     1.2551   2.521   0.0118 *  \nage                                   0.8076     0.1813   4.454 8.93e-06 ***\nfactor(study_arm)TSC:factor(order)1  -0.5347     1.6755  -0.319   0.7497    \nfactor(study_arm)TSC:factor(order)3   2.0356     1.6502   1.234   0.2175    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.65 on 1858 degrees of freedom\nMultiple R-squared:  0.03779,\tAdjusted R-squared:  0.03468 \nF-statistic: 12.16 on 6 and 1858 DF,  p-value: 1.873e-13\n```\n:::\n\n```{.r .cell-code}\nggplot(qinfo,aes(x = age, y = score, color = order)) +\n  geom_point(position = \"jitter\") +\n  geom_smooth(method='lm')\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/lm-age-1.png){width=672}\n:::\n:::\n\n\n**Age plays a small role over time** -- the increasing age interpret part of the increasing QOLIE over visits and time. The order is no longer have a significance effect.\n\nthe lm formula is (only age is not a dummy variable):\n\n\n$$QOLIE = 37.1728684 + -0.1890242 * TSC + 2.0521008 * order_1 + 3.1645446 * order_3 \\\\ + -0.5347111 * TSC * order_1 + 2.035648 * TSC*order_3 + 0.807643 * age$$\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(score ~ factor(study_arm)*factor(order) + factor(gender), qinfo))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = score ~ factor(study_arm) * factor(order) + factor(gender), \n    data = qinfo)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-55.501  -8.089   1.062   9.344  43.030 \n\nCoefficients:\n                                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                          48.0812     0.9717  49.481  < 2e-16 ***\nfactor(study_arm)TSC                 -0.1947     1.1726  -0.166 0.868166    \nfactor(order)1                        2.2458     1.2347   1.819 0.069085 .  \nfactor(order)3                        4.6461     1.2161   3.820 0.000138 ***\nfactor(gender)2                       0.9349     0.7053   1.326 0.185136    \nfactor(study_arm)TSC:factor(order)1  -0.5467     1.6837  -0.325 0.745458    \nfactor(study_arm)TSC:factor(order)3   2.0338     1.6582   1.227 0.220160    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.72 on 1858 degrees of freedom\nMultiple R-squared:  0.02844,\tAdjusted R-squared:  0.0253 \nF-statistic: 9.063 on 6 and 1858 DF,  p-value: 8.648e-10\n```\n:::\n:::\n\n\n**Gender plays no role.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(score ~ factor(study_arm)*factor(order) + age + factor(city), qinfo))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = score ~ factor(study_arm) * factor(order) + age + \n    factor(city), data = qinfo)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-52.041  -8.299   0.897   9.313  45.502 \n\nCoefficients:\n                                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                          37.5086     2.7986  13.403  < 2e-16 ***\nfactor(study_arm)TSC                 -0.5679     1.1565  -0.491 0.623436    \nfactor(order)1                        2.0376     1.2168   1.675 0.094187 .  \nfactor(order)3                        3.3619     1.2428   2.705 0.006892 ** \nage                                   0.7000     0.1807   3.874 0.000111 ***\nfactor(city)Kano                      3.4593     0.8506   4.067 4.96e-05 ***\nfactor(city)Zaria                    -1.3909     0.9678  -1.437 0.150850    \nfactor(study_arm)TSC:factor(order)1  -0.5013     1.6584  -0.302 0.762453    \nfactor(study_arm)TSC:factor(order)3   2.0354     1.6333   1.246 0.212846    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.5 on 1856 degrees of freedom\nMultiple R-squared:  0.05843,\tAdjusted R-squared:  0.05437 \nF-statistic:  14.4 on 8 and 1856 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n**City plays a role that Zario \\< Keduna \\< Kano.**\n\n\n$$QOLIE = 37.5085908 + -0.5679033 * TSC + 2.0376459 * order_1 + 3.3619162 * order_3 + -0.5013377 * TSC * order_1 + 2.0354024 * TSC * order_3 \\\\ + 0.7000472 * age + 3.4592855 * Kano + -1.3908916 * Zaria$$\n\n\n## VAS\n\n### Inclusion Criteria\n\n1.  if the *missed_fu* is like \"no\" or \"on time\", include no matter any missing. There're 458 records(2.814478 % of all) meeting the conditions.\n\n2.  if the *missed_fu* is **NA** or \"Visit Done\", inclusion depends on whether they filled all of *follow_up_care_form_complete*, *confirmseize*, *weight_fu_v2*, *seizeclass*. There 're 15054 records (92.5090641 % of all) meeting the conditions.\n\n3.  if the *missed_fu* answers something else, exclude. There're 761 records (4.6764579 % of all) excluded.\n\n### Demographic\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfcf_c %>% distinct(record_id) %>% left_join(gender) %>%\n  mutate(gender=factor(gender,levels=1:2,labels=c(\"Female\",\"Male\"))) %>%\n  count(study_arm, gender) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable(caption = \"Gender in 2 arms\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gender in 2 arms</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> gender </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 269 </td>\n   <td style=\"text-align:left;\"> 37% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 458 </td>\n   <td style=\"text-align:left;\"> 63% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 272 </td>\n   <td style=\"text-align:left;\"> 36% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 491 </td>\n   <td style=\"text-align:left;\"> 64% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nfcf_c %>% distinct(record_id) %>% left_join(location) %>%\n  count(study_arm, city) %>% group_by(study_arm) %>%\n  mutate(pct = percent(n/sum(n))) %>%\n  kable(caption = \"City in 2 arms\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>City in 2 arms</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> study_arm </th>\n   <th style=\"text-align:left;\"> city </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 156 </td>\n   <td style=\"text-align:left;\"> 21.5% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 372 </td>\n   <td style=\"text-align:left;\"> 51.2% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EUC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 199 </td>\n   <td style=\"text-align:left;\"> 27.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kaduna </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:left;\"> 24.8% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Kano </td>\n   <td style=\"text-align:right;\"> 401 </td>\n   <td style=\"text-align:left;\"> 52.6% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TSC </td>\n   <td style=\"text-align:left;\"> Zaria </td>\n   <td style=\"text-align:right;\"> 173 </td>\n   <td style=\"text-align:left;\"> 22.7% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nggplot(fcf_c, aes(x = agefu, y = qolie, color = factor(redcap_repeat_instance))) +\n  geom_point(position = \"dodge\", alpha = 0.8) +\n  scale_color_brewer(palette = \"Spectral\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/demograohic-1.png){width=672}\n:::\n:::\n\n\n### Analysis of VAS over time\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfcf_c %>%\n  ggplot(aes(x=qolie)) + \n  geom_histogram(binwidth = 1) +\n  facet_grid(study_arm~.) +\n  theme_minimal() +\n  xlab(\"VAS\") + ylab(\"Freq\") +\n  ggtitle(\"Distribution of valid scores\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/vas-analysis-1.png){width=672}\n:::\n:::\n\n\n#### Main effects and interactions of study arms and visit times\n\nFor the cost-effectiveness analysis, we need to compare the utilities between the two arms along with the 10 follow up visits. Study arm is a two-level factor as EUC is the control group and TSC is the treatment group. lm function creates a dummy variable named TSC(the line: **factor(study_arm) TSC**) that *TSC* = 1 for TSC group and *TSC* = 0 for EUC group.\n\nThe main effect of visits is to use the **Screening** (**visit 0**) as the baseline. There are 10 dummy variables for all follow-up visits: if all are 0, it refers to the screening visit; if *visit1* = 1, the others should all be 0 and this refers to Follow-up Visit 1.\n\nThe interaction shows the expected difference in the effect of the N-th visit(compared to the screening) for TSC participants versus EUC participants. For example, **factor(study_arm)TSC:factor(visit)1** means *visit1* = 1 and *TSC* = 1, which compares the VAS of the TSC arm on the first follow-up visit with that of the EUC arm. If it is the screening visit or in EUC arm, all the interaction portions will be zero.\n\nThe intercept, is the average VAS of screening visit in EUC arm.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfcf_i = fcf_c %>% filter(!is.na(qolie)) %>% select(record_id, study_arm, visit = redcap_repeat_instance, qolie, age = agefu, gender, city) %>% mutate(gender = ifelse(gender == 1, \"Female\", \"Male\"), visit = as.numeric(visit)) %>% bind_rows(bs %>% filter(qolie_48_1117_v0_complete == \"2\") %>% select(record_id = unique_id, study_arm, qolie = vas_qolie_48, age, gender, city) %>% mutate(visit = 0))\n\nsummary(lm(qolie ~ factor(study_arm)*factor(visit), fcf_i))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = qolie ~ factor(study_arm) * factor(visit), data = fcf_i)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-81.839 -11.000   1.132  11.548  49.436 \n\nCoefficients:\n                                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                            48.564      1.238  39.241  < 2e-16 ***\nfactor(study_arm)TSC                    3.804      1.694   2.245 0.024793 *  \nfactor(visit)1                          5.077      1.398   3.632 0.000282 ***\nfactor(visit)2                          8.037      1.397   5.752 9.02e-09 ***\nfactor(visit)3                         12.436      1.398   8.893  < 2e-16 ***\nfactor(visit)4                         15.304      1.400  10.933  < 2e-16 ***\nfactor(visit)5                         19.993      1.398  14.303  < 2e-16 ***\nfactor(visit)6                         22.857      1.393  16.412  < 2e-16 ***\nfactor(visit)7                         26.146      1.393  18.769  < 2e-16 ***\nfactor(visit)8                         29.753      1.390  21.405  < 2e-16 ***\nfactor(visit)9                         30.002      1.391  21.575  < 2e-16 ***\nfactor(visit)10                        30.999      1.390  22.298  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)1     2.524      1.919   1.315 0.188444    \nfactor(study_arm)TSC:factor(visit)2     5.455      1.922   2.838 0.004550 ** \nfactor(study_arm)TSC:factor(visit)3     4.445      1.926   2.307 0.021049 *  \nfactor(study_arm)TSC:factor(visit)4     6.035      1.925   3.135 0.001722 ** \nfactor(study_arm)TSC:factor(visit)5     4.110      1.923   2.136 0.032656 *  \nfactor(study_arm)TSC:factor(visit)6     5.199      1.917   2.712 0.006691 ** \nfactor(study_arm)TSC:factor(visit)7     5.080      1.914   2.654 0.007965 ** \nfactor(study_arm)TSC:factor(visit)8     5.718      1.911   2.993 0.002771 ** \nfactor(study_arm)TSC:factor(visit)9     6.082      1.912   3.181 0.001470 ** \nfactor(study_arm)TSC:factor(visit)10    6.727      1.912   3.518 0.000436 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.97 on 14640 degrees of freedom\nMultiple R-squared:  0.2942,\tAdjusted R-squared:  0.2932 \nF-statistic: 290.6 on 21 and 14640 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\ninteraction.plot(x.factor = fcf_i$visit, #x-axis variable\n                 trace.factor = fcf_i$study_arm, #variable for lines\n                 response = fcf_i$qolie, #y-axis variable\n                 fun = mean, #metric to plot\n                 fixed = TRUE, \n                 ylab = \"QOLIE Score (marginal mean)\",\n                 xlab = \"Follow-up Visits\",\n                 col = c(\"pink\", \"blue\"),\n                 lty = 1, #line type\n                 lwd = 2, #line width\n                 trace.label = \"Study Arm\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/lm-1.png){width=672}\n:::\n:::\n\n\nThe linear model formula is:\n\n\n$$VAS = 48.5638298 + 3.8036121 *TSC + 5.0769327 *Visit_1 + 8.0370474 *Visit_2 + 12.4361702 * Visit_3 + 15.3039265 *Visit_4 + 19.993355 * Visit_5 \\\\\n + 22.8568501 *Visit_6 + 26.1463975 * Visit_7 + 29.7532773 * Visit_8 + 30.0018127 * Visit_9 + 30.9988443 * Visit_{10} \\\\\n + 2.5244179  * TSC * Visit_1 + 5.4552583 * TSC * Visit_2 + 4.4445842 * TSC * Visit_3 + 6.0348463 * TSC * Visit_4 + 4.1095422 * TSC * Visit_5 \\\\\n + 5.1993669 * TSC * Visit_6 + 5.0802862 * TSC * Visit_7 + 5.718331 * TSC * Visit_8 + 6.0822727 * TSC * Visit_9 + 6.7270472 * TSC * Visit_{10} $$\n\n**the number of \\* shows the level of significance. Here, from the interaction parts, we can find the score of TSC is significantly higher than EUC for every visit.**\n\n**For the screening visit, the score of TSC is 3.804 higher than the EUC(p = 0.02 shows significant group difference in the popularity). The difference expands over the visits**\n\n#### Age as covariant\n\nAs it cost 2 years for the whole process, the kids may have improved VAS just due to the increasing age, while age is not a element of our research interest-- that's why we add age as a covariant.\n\nTo highlight the age, here we use residuals of VAS after excluding the age effect, rather than just add age into the model.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(qolie ~ age, fcf_i))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = qolie ~ age, data = fcf_i)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-73.511 -21.140   2.607  16.354  29.535 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 70.19530    0.43083 162.929  < 2e-16 ***\nage          0.19280    0.03716   5.189 2.15e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 20.18 on 14068 degrees of freedom\n  (592 observations deleted due to missingness)\nMultiple R-squared:  0.00191,\tAdjusted R-squared:  0.001839 \nF-statistic: 26.92 on 1 and 14068 DF,  p-value: 2.147e-07\n```\n:::\n\n```{.r .cell-code}\nfcf_a = bind_cols(fcf_i %>% filter(!is.na(age)), residuals(lm(qolie ~ age, fcf_i)))\ncolnames(fcf_a)[8] = \"age_residual\" \n\nsummary(lm(age_residual ~ factor(study_arm)*factor(visit), fcf_a))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = age_residual ~ factor(study_arm) * factor(visit), \n    data = fcf_a)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-82.981 -11.134   0.767  12.045  49.687 \n\nCoefficients:\n                                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                           -24.331      1.245 -19.549  < 2e-16 ***\nfactor(study_arm)TSC                    3.760      1.704   2.207 0.027346 *  \nfactor(visit)1                          5.890      1.406   4.190 2.81e-05 ***\nfactor(visit)2                          8.841      1.405   6.292 3.23e-10 ***\nfactor(visit)3                         13.230      1.406   9.407  < 2e-16 ***\nfactor(visit)4                         16.069      1.408  11.415  < 2e-16 ***\nfactor(visit)5                         20.729      1.406  14.746  < 2e-16 ***\nfactor(visit)6                         23.547      1.401  16.813  < 2e-16 ***\nfactor(visit)7                         26.783      1.402  19.107  < 2e-16 ***\nfactor(visit)8                         30.406      1.399  21.736  < 2e-16 ***\nfactor(visit)9                         30.558      1.406  21.735  < 2e-16 ***\nfactor(visit)10                        31.010      1.461  21.229  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)1     2.518      1.930   1.305 0.191991    \nfactor(study_arm)TSC:factor(visit)2     5.448      1.933   2.818 0.004840 ** \nfactor(study_arm)TSC:factor(visit)3     4.424      1.937   2.284 0.022388 *  \nfactor(study_arm)TSC:factor(visit)4     6.022      1.936   3.111 0.001868 ** \nfactor(study_arm)TSC:factor(visit)5     4.110      1.934   2.125 0.033617 *  \nfactor(study_arm)TSC:factor(visit)6     5.166      1.928   2.680 0.007377 ** \nfactor(study_arm)TSC:factor(visit)7     5.131      1.926   2.664 0.007741 ** \nfactor(study_arm)TSC:factor(visit)8     5.634      1.923   2.930 0.003400 ** \nfactor(study_arm)TSC:factor(visit)9     6.017      1.934   3.112 0.001863 ** \nfactor(study_arm)TSC:factor(visit)10    7.778      2.026   3.839 0.000124 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 17.06 on 14048 degrees of freedom\nMultiple R-squared:  0.2858,\tAdjusted R-squared:  0.2848 \nF-statistic: 267.8 on 21 and 14048 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\ninteraction.plot(x.factor = fcf_a$visit, #x-axis variable\n                 trace.factor = fcf_a$study_arm, #variable for lines\n                 response = 69.57732 + fcf_a$age_residual, #y-axis variable\n                 fun = mean, #metric to plot\n                 fixed = TRUE, \n                 ylab = \"the QOLIE Score excluded the covariance effect of age\",\n                 xlab = \"Follow-up Visits\",\n                 col = c(\"pink\", \"blue\"),\n                 lty = 1, #line type\n                 lwd = 2, #line width\n                 trace.label = \"Study Arm\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/age-lm-1.png){width=672}\n:::\n:::\n\nage plays a role to interpret the increasing tendency of VAS over 10 visits, but the Task-shift treatment still have better effects than the the control group proved to be significant from the interaction estimates.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(qolie ~ factor(study_arm)*factor(visit) + factor(gender), fcf_i))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = qolie ~ factor(study_arm) * factor(visit) + factor(gender), \n    data = fcf_i)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-81.846 -10.989   1.144  11.560  49.430 \n\nCoefficients:\n                                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                           48.5517     1.2523  38.772  < 2e-16 ***\nfactor(study_arm)TSC                   3.8032     1.6945   2.244 0.024817 *  \nfactor(visit)1                         5.0774     1.3979   3.632 0.000282 ***\nfactor(visit)2                         8.0375     1.3974   5.752 9.01e-09 ***\nfactor(visit)3                        12.4368     1.3985   8.893  < 2e-16 ***\nfactor(visit)4                        15.3044     1.3999  10.933  < 2e-16 ***\nfactor(visit)5                        19.9937     1.3979  14.303  < 2e-16 ***\nfactor(visit)6                        22.8573     1.3927  16.412  < 2e-16 ***\nfactor(visit)7                        26.1469     1.3931  18.768  < 2e-16 ***\nfactor(visit)8                        29.7537     1.3901  21.404  < 2e-16 ***\nfactor(visit)9                        30.0023     1.3907  21.574  < 2e-16 ***\nfactor(visit)10                       30.9993     1.3903  22.297  < 2e-16 ***\nfactor(gender)Male                     0.0185     0.2916   0.063 0.949403    \nfactor(study_arm)TSC:factor(visit)1    2.5246     1.9194   1.315 0.188429    \nfactor(study_arm)TSC:factor(visit)2    5.4554     1.9225   2.838 0.004551 ** \nfactor(study_arm)TSC:factor(visit)3    4.4447     1.9263   2.307 0.021051 *  \nfactor(study_arm)TSC:factor(visit)4    6.0351     1.9250   3.135 0.001721 ** \nfactor(study_arm)TSC:factor(visit)5    4.1097     1.9236   2.137 0.032654 *  \nfactor(study_arm)TSC:factor(visit)6    5.1997     1.9171   2.712 0.006690 ** \nfactor(study_arm)TSC:factor(visit)7    5.0805     1.9143   2.654 0.007964 ** \nfactor(study_arm)TSC:factor(visit)8    5.7185     1.9109   2.993 0.002771 ** \nfactor(study_arm)TSC:factor(visit)9    6.0824     1.9120   3.181 0.001470 ** \nfactor(study_arm)TSC:factor(visit)10   6.7271     1.9121   3.518 0.000436 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.97 on 14639 degrees of freedom\nMultiple R-squared:  0.2942,\tAdjusted R-squared:  0.2931 \nF-statistic: 277.4 on 22 and 14639 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\ncat(\"There is no difference between the genders. \")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThere is no difference between the genders. \n```\n:::\n\n```{.r .cell-code}\nsummary(lm(qolie ~ factor(study_arm)*factor(visit) + factor(city), fcf_i))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = qolie ~ factor(study_arm) * factor(visit) + factor(city), \n    data = fcf_i)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-80.658 -10.740   0.148  12.039  50.571 \n\nCoefficients:\n                                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                           53.0102     1.2484  42.461  < 2e-16 ***\nfactor(study_arm)TSC                   3.7995     1.6757   2.267 0.023381 *  \nfactor(visit)1                         5.2793     1.3824   3.819 0.000135 ***\nfactor(visit)2                         8.2531     1.3820   5.972  2.4e-09 ***\nfactor(visit)3                        12.6482     1.3831   9.145  < 2e-16 ***\nfactor(visit)4                        15.4744     1.3844  11.178  < 2e-16 ***\nfactor(visit)5                        20.1247     1.3824  14.558  < 2e-16 ***\nfactor(visit)6                        23.0330     1.3773  16.723  < 2e-16 ***\nfactor(visit)7                        26.3171     1.3778  19.101  < 2e-16 ***\nfactor(visit)8                        29.9403     1.3747  21.779  < 2e-16 ***\nfactor(visit)9                        30.1900     1.3753  21.951  < 2e-16 ***\nfactor(visit)10                       31.1832     1.3749  22.680  < 2e-16 ***\nfactor(city)Kano                      -5.5807     0.3457 -16.145  < 2e-16 ***\nfactor(city)Zaria                     -6.5236     0.3994 -16.333  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)1    2.2797     1.8983   1.201 0.229796    \nfactor(study_arm)TSC:factor(visit)2    5.2106     1.9013   2.741 0.006142 ** \nfactor(study_arm)TSC:factor(visit)3    4.2239     1.9051   2.217 0.026629 *  \nfactor(study_arm)TSC:factor(visit)4    5.8167     1.9039   3.055 0.002253 ** \nfactor(study_arm)TSC:factor(visit)5    3.8950     1.9024   2.047 0.040636 *  \nfactor(study_arm)TSC:factor(visit)6    5.0094     1.8959   2.642 0.008246 ** \nfactor(study_arm)TSC:factor(visit)7    4.8576     1.8932   2.566 0.010303 *  \nfactor(study_arm)TSC:factor(visit)8    5.4886     1.8898   2.904 0.003687 ** \nfactor(study_arm)TSC:factor(visit)9    5.8484     1.8909   3.093 0.001986 ** \nfactor(study_arm)TSC:factor(visit)10   6.5283     1.8910   3.452 0.000557 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.78 on 14638 degrees of freedom\nMultiple R-squared:  0.3098,\tAdjusted R-squared:  0.3087 \nF-statistic: 285.6 on 23 and 14638 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\ncat(\"As for the cities, Keduna > Kano > Zaria\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAs for the cities, Keduna > Kano > Zaria\n```\n:::\n:::\n\nAs city is one of the variable of our interest, we include it into the linear model and find that participants in different cities will have significantly different average VAS.\n\n# Comparison between VAS and QOLIE\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qolie = qinfo %>% mutate(visit = ifelse(order == 1, 3, ifelse(order == 3, 10, 0))) %>%\n              group_by(study_arm, visit) %>%\n              summarise(qolie = mean(score), qolie_sd = sd(score))\n\nfcf_i %>% \n  group_by(study_arm, visit) %>%\n  summarise(vas = mean(qolie), vas_sd = sd(qolie)) %>%\n  ggplot(aes(x = visit, y = vas, color = study_arm)) +\n  geom_line(linetype = 1) +\n  geom_point() + \n  # geom_errorbar(aes(ymin = vas - vas_sd, ymax = vas + vas_sd), width = .2) +\n  geom_line(data = data_qolie, \n            aes(x = visit, y = qolie, color = study_arm), linetype = 3) +\n  geom_point(data = data_qolie, \n            aes(x = visit, y = qolie, color = study_arm)) +\n  # geom_errorbar(data = data_qolie, aes(ymin = qolie - qolie_sd, ymax = qolie + qolie_sd), width = .2) +\n  ylab(\"quality of life score (0 - 100)\") +\n  xlim(0, 10) + \n  scale_x_continuous(breaks = seq(0,10,1), limits = c(0,10)) +\n  theme_minimal() +\n  annotate(\"text\", x = 3, y = 73, label = \"VAS\") +\n  annotate(\"text\", x = 5, y = 54, label = \"QOLIE\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/fig-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## should the x-axis to be months instead of visits?\n```\n:::\n\nThe two measures had similar tendency but the two arms of VAS had significance difference between them while QOLIE didn't. As QOLIE-AD-48 and QOLIE-31 are longer questionnaires compared to one-question VAS, they might be more difficult for the patients to fill in, which led to a narrower result.\n\n# Cost\n\nsee the excel sheet. Right now use the avg unit cost for each yr. May need to consider the inflation and discounting.\n\n# DALY\n\n## age of onset of disease\n\n*What was the age of the child when the first seizure happened?*\n\n::: {.cell}\n\n```{.r .cell-code}\n# bs %>% filter(!is.na(onset_age)) %>% select(id = unique_id, study_arm, onset_age) %>% filter(!is.na(id)) %>% \n#   kable(caption = \"Onset age is submitted in text\") %>%\n#   kable_styling() %>% \n#   scroll_box()\n\nonsetAge = bs %>% filter(!is.na(onset_age)) %>% select(id = unique_id, study_arm, onset_age, age, dob, gender) %>% filter(!is.na(id)) %>% \n  mutate(onset_age = str_replace(onset_age, \" and half\", \".5\"), onset_age = str_replace(onset_age, \"and half\", \".5\"), onset_age =  str_replace_all(onset_age, c(\"one\" = \"1\", \"first\" = \"1\",\"First\" = \"1\", \"A \" = \"1\", \"I\" = \"1\", \"One\" = \"1\", \"two\" = \"2\", \"Two\" = \"2\", \"second\" = \"2\", \"three\" = \"3\", \"Three\" = \"3\", \"third\" = \"3\", \"four\" = \"4\", \"five\" = \"5\", \"six\" = \"6\",\"Six\" = \"6\", \"seven\" = \"7\", \"eight\" = \"8\", \"nine\" = \"9\", \"ten\" = \"10\", \"birth\" = \"0\", \"born\" = \"0\", \"At birht\" = \"0\", \"After Brith\" = \"0\", \"2019\" = \"2\", \"November 2014\" = \"4\"))) %>%\n  mutate(onset = ifelse(str_detect(onset_age, \"Last month\"), round(age - 1/12), ifelse(str_detect(onset_age, \"d\")|str_detect(onset_age, \"D\"), round(parse_number(onset_age)/365.25), ifelse(str_detect(onset_age, \"y\") & (str_detect(onset_age, \"(6|8)( |)m\")), round(parse_number(onset_age) + 1), ifelse(str_detect(onset_age, \"y\")|str_detect(onset_age, \"Y\"), round(parse_number(onset_age)), ifelse(str_detect(onset_age, \"m\")|str_detect(onset_age, \"M\"), round(parse_number(onset_age)/12), ifelse(str_detect(onset_age, \"w\")|str_detect(onset_age, \"W\"), round(parse_number(onset_age)/52), parse_number(onset_age))))))))\n\nonsetAge %>% \n  filter(!is.na(onset)) %>%\n  group_by(study_arm, gender) %>% \n  summarise(meanOnsetAge = mean(onset), sdOnsetAge = sd(onset))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4  4\n# Groups:   study_arm [2]\n  study_arm gender meanOnsetAge sdOnsetAge\n  <chr>     <chr>         <dbl>      <dbl>\n1 EUC       Female         3.40       3.39\n2 EUC       Male           3.26       3.51\n3 TSC       Female         3.13       3.33\n4 TSC       Male           3.75       3.53\n```\n:::\n\n```{.r .cell-code}\nonsetAge %>% \n  ggplot(aes(x = onset)) + \n  geom_histogram(binwidth = 1) +\n  facet_grid(study_arm ~ gender) + \n  stat_bin(binwidth=1, geom=\"text\", aes(label=..count..), vjust = -0.25) +\n  theme_minimal() +\n  xlab(\"Age (in years)\") + ylab(\"Freq\") +\n  ggtitle(\"Onset Age Distribution for 2 arms\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/onset-age-1.png){width=672}\n:::\n:::\n\n## severity\n\nwe can use the frequency to get the severity.\n\nsevere epilepsy, defined as an average seizure frequency of more than or equal to once per month; less severe epilepsy with a seizure frequency of less than once a month, or no seizures in the past year while untreated but still fulfilling the criteria of active epilepsy; and seizure-free, treated epilepsy, defined as not having seizures in the past year while on treatment.\n\n**The only question is that all the patients in our researsh should be considered as under treatment if they have less severe epilepsy.**\n\n::: {.cell}\n\n```{.r .cell-code}\n#melt\npreInterval = cbind(fudw['record_id'], stack(fudw[c(\"d01\",\"d12\", \"d23\", \"d34\", \"d45\", \"d56\", \"d67\", \"d78\", \"d89\", \"d90\")])) %>% mutate(visit = ifelse(ind == \"d90\", 10, as.numeric(ind[-1]))) %>% select(record_id, visit, interval = values)\n\nseizure_tsc = fcf_c %>% filter(!is.na(expseiz) & study_arm == \"TSC\") %>% mutate(seiz_times = ifelse(is.na(how_many_seiz_v2), 0, how_many_seiz_v2)) %>% mutate(visit = as.numeric(redcap_repeat_instance)) %>% left_join(preInterval, by = c(\"record_id\", \"visit\")) %>% mutate(seiz_freq = 365.25/12 * seiz_times / interval)\nseizure_euc = fcf_c %>% filter(seize_since_last_euc_v2 != 2 & study_arm == \"EUC\") %>% mutate(seiz_times = ifelse(is.na(number_seiz), 0, number_seiz)) %>% mutate(visit = as.numeric(redcap_repeat_instance)) %>% left_join(preInterval, by = c(\"record_id\", \"visit\")) %>% mutate(seiz_freq = 365.25/12 * seiz_times / interval)\nseizure_times = rbind(seizure_tsc, seizure_euc) %>% filter(!is.na(seiz_freq) & seiz_freq != Inf)\n\nsummary(lm(seiz_freq ~ factor(study_arm)*factor(visit) + agefu + factor(gender) + factor(city), seizure_times))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = seiz_freq ~ factor(study_arm) * factor(visit) + \n    agefu + factor(gender) + factor(city), data = seizure_times)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-53.231  -1.237  -0.439   0.310 292.816 \n\nCoefficients:\n                                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                           10.21131    0.30781  33.174  < 2e-16 ***\nfactor(study_arm)TSC                  -4.34169    0.35074 -12.379  < 2e-16 ***\nfactor(visit)2                        -7.13917    0.35832 -19.924  < 2e-16 ***\nfactor(visit)3                        -8.23978    0.35901 -22.952  < 2e-16 ***\nfactor(visit)4                        -9.30574    0.35983 -25.861  < 2e-16 ***\nfactor(visit)5                        -9.34975    0.35717 -26.177  < 2e-16 ***\nfactor(visit)6                        -9.83982    0.35443 -27.763  < 2e-16 ***\nfactor(visit)7                        -9.86135    0.35510 -27.770  < 2e-16 ***\nfactor(visit)8                        -9.87230    0.35350 -27.927  < 2e-16 ***\nfactor(visit)9                        -9.79415    0.35833 -27.333  < 2e-16 ***\nfactor(visit)10                      -10.24561    0.39000 -26.270  < 2e-16 ***\nagefu                                 -0.03854    0.01243  -3.102  0.00193 ** \nfactor(gender)2                        0.12382    0.11755   1.053  0.29222    \nfactor(city)Kano                       0.62648    0.14410   4.348 1.39e-05 ***\nfactor(city)Zaria                      1.25123    0.16495   7.585 3.53e-14 ***\nfactor(study_arm)TSC:factor(visit)2    3.84985    0.49874   7.719 1.25e-14 ***\nfactor(study_arm)TSC:factor(visit)3    4.03640    0.50091   8.058 8.39e-16 ***\nfactor(study_arm)TSC:factor(visit)4    4.28884    0.50008   8.576  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)5    4.20612    0.49825   8.442  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)6    4.26441    0.49453   8.623  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)7    4.23470    0.49343   8.582  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)8    4.14546    0.49172   8.431  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)9    4.10195    0.49820   8.234  < 2e-16 ***\nfactor(study_arm)TSC:factor(visit)10   4.12469    0.55031   7.495 7.03e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.595 on 13596 degrees of freedom\n  (592 observations deleted due to missingness)\nMultiple R-squared:  0.1245,\tAdjusted R-squared:  0.123 \nF-statistic: 84.04 on 23 and 13596 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\ninteraction.plot(x.factor = seizure_times$visit, #x-axis variable\n                 trace.factor = seizure_times$study_arm, #variable for lines\n                 response = seizure_times$seiz_freq, #y-axis variable\n                 fun = mean, #metric to plot\n                 ylab = \"frequency of seizures (times per month)\",\n                 xlab = \"Visit\",\n                 col = c(\"pink\", \"blue\"),\n                 lty = 1, #line type\n                 lwd = 2, #line width\n                 trace.label = \"Study Arm\")\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/seizure-times-1.png){width=672}\n:::\n\n```{.r .cell-code}\nseizure_times %>% \n  ggplot(aes(x = seiz_freq)) + \n  geom_histogram(binwidth = 1) +\n  facet_grid(study_arm ~ .) + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](bridge_brief_files/figure-html/seizure-times-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# to get the decrease of DALY, we need to get the beginning DALY and final DALY for 2 arms\npct_severe = seizure_times %>% mutate(severity = ifelse(seiz_freq >= 1, \"severe epilepsy\", \"others\")) %>%\n  group_by(study_arm, visit) %>% count(severity) %>% mutate(pct = percent(n / sum(n))) %>% filter(severity == \"severe epilepsy\") %>% ungroup() %>% select(visit,n, pct) \n\npct_severe %>%\n  kable(caption=\"percent of severe epilepsy in 2 arms among 10 visits\") %>%\n  kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\")) %>%\n  pack_rows(\"EUC\",1,10) %>%\n  pack_rows(\"TSC\",11,20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>percent of severe epilepsy in 2 arms among 10 visits</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> visit </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> pct </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"10\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>EUC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:right;\"> 378 </td>\n   <td style=\"text-align:left;\"> 56% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:right;\"> 373 </td>\n   <td style=\"text-align:left;\"> 55% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:right;\"> 354 </td>\n   <td style=\"text-align:left;\"> 52.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 4 </td>\n   <td style=\"text-align:right;\"> 268 </td>\n   <td style=\"text-align:left;\"> 40% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 5 </td>\n   <td style=\"text-align:right;\"> 267 </td>\n   <td style=\"text-align:left;\"> 39% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 6 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:left;\"> 23% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 7 </td>\n   <td style=\"text-align:right;\"> 158 </td>\n   <td style=\"text-align:left;\"> 22% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 8 </td>\n   <td style=\"text-align:right;\"> 139 </td>\n   <td style=\"text-align:left;\"> 19% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 9 </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:left;\"> 21% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 10 </td>\n   <td style=\"text-align:right;\"> 68 </td>\n   <td style=\"text-align:left;\"> 9% </td>\n  </tr>\n  <tr grouplength=\"10\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>TSC</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 1 </td>\n   <td style=\"text-align:right;\"> 313 </td>\n   <td style=\"text-align:left;\"> 43% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 2 </td>\n   <td style=\"text-align:right;\"> 372 </td>\n   <td style=\"text-align:left;\"> 52.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 3 </td>\n   <td style=\"text-align:right;\"> 331 </td>\n   <td style=\"text-align:left;\"> 47.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 4 </td>\n   <td style=\"text-align:right;\"> 270 </td>\n   <td style=\"text-align:left;\"> 38% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 5 </td>\n   <td style=\"text-align:right;\"> 239 </td>\n   <td style=\"text-align:left;\"> 34% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 6 </td>\n   <td style=\"text-align:right;\"> 152 </td>\n   <td style=\"text-align:left;\"> 21% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 7 </td>\n   <td style=\"text-align:right;\"> 118 </td>\n   <td style=\"text-align:left;\"> 16% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 8 </td>\n   <td style=\"text-align:right;\"> 94 </td>\n   <td style=\"text-align:left;\"> 12% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 9 </td>\n   <td style=\"text-align:right;\"> 111 </td>\n   <td style=\"text-align:left;\"> 15% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 10 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:left;\"> 3% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# \n# cat(\"set limits for outliners: [Q1-1.5*IQR, Q3+1.5*IQR]\")\n# \n# # delete outliners\n# quartiles <- quantile(seizure_times$seiz_freq, probs=c(.25, .75), na.rm = FALSE)\n# IQR <- IQR(seizure_times$seiz_freq)\n# Lower <- quartiles[1] - 1.5*IQR\n# Upper <- quartiles[2] + 1.5*IQR \n# seizure_times %>% filter(seiz_freq > Lower & seiz_freq < Upper) %>% mutate(severity = ifelse(seiz_freq >= 1, \"severe epilepsy\", \"seizure-free, treated epilepsy\")) %>%\n#   group_by(study_arm, visit = redcap_repeat_instance) %>% count(severity) %>% mutate(pct = percent(n / sum(n))) %>% ungroup() %>%select(-study_arm) %>% \n#   kable(caption=\"percent of epilepsy classes in 2 arms among 10 visits without outliners\") %>% \n#   kable_styling(full_width = F, bootstrap_options = c(\"striped\", \"hover\")) %>%\n#   pack_rows(\"EUC\",1,20) %>%\n#   pack_rows(\"TSC\",21,40)\n```\n:::\n\nAs the intervals between screening and follow up visit 1 is not as scheduled stably as intervals between visits, we may use the reported seizure frequency in the Follow up visit 2(the 2th in the plot) as the baseline.\n\n## Calculation of DALY\n\nsevere epilepsy, defined as an average seizure frequency of more than or equal to once per month;\\\nless severe epilepsy with a seizure frequency of less than once a month, or no seizures in the past year while untreated but still fulfilling the criteria of active epilepsy;\\\nand seizure-free, treated epilepsy, defined as not having seizures in the past year while on treatment.\n\nif seiz_freq = 0 from visit 1 - 7 or 2/3 - 9 or 5 - 9 or 7 - 10, later can be regarded as seizure-free as far as no seizure happened.\n\nDisability Weight (Essential for the YLDs) --\n\n-   Severe epilepsy: 0.552\n\n-   Less epilepsy: 0.263\n\n-   seizure-free, treated epilepsy: 0.049\n\nSo we can get the difference between 2 arms.\n\nFor the YLLs part, we can use YLLs or mortality from GBD. However, as GBD only have the epilepsy category (not detailed), the 2 arms should be the same -- if we don't consider some of them recovered at the end.\n\n::: {.cell}\n\n```{.r .cell-code}\n# pct_seizure_free = seizure_times %>% filter(seiz_freq == 0) %>% count(record_id, visit, study_arm) %>% spread(visit, n, fill = 0, sep = \"\") %>%\n#   mutate(\n#     zero_0_12 = ifelse(visit1 == 1 & visit2 == 1 & visit3 == 1 & visit4 == 1 & visit5 == 1 & visit6 == 1 & visit7 == 1, TRUE, FALSE),\n#     zero_3_15 = ifelse(visit3 == 1 & visit4 == 1 & visit5 == 1 & visit6 == 1 & visit7 == 1 & visit8 == 1, TRUE, FALSE),\n#     zero_6_18 = ifelse(visit5 == 1 & visit6 == 1 & visit7 == 1 & visit8 == 1 & visit9 == 1, TRUE, FALSE)) %>%\n#   mutate(free_12_15 = ifelse(zero_0_12 & visit8 == 1, TRUE, FALSE),\n#          free_15_18 = ifelse(zero_3_15 & visit9 == 1, TRUE, FALSE),\n#          free_18_24 = ifelse(zero_6_18 & visit10 == 1, TRUE, FALSE))\n\n# count how many NAs in each col\n# sapply(severity, function(x) sum(is.na(x)))\n\nseverity = seizure_times %>% select(record_id, visit, study_arm, seiz_freq) %>% spread(visit, seiz_freq, sep = \"\") %>% drop_na() %>%\n  mutate(\n    zero_0_12 = ifelse(visit1 == 0 & visit2 == 0 & visit3 == 0 & visit4 == 0 & visit5 == 0 & visit6 == 0 & visit7 == 0, TRUE, FALSE),\n    zero_3_15 = ifelse(visit3 == 0 & visit4 == 0 & visit5 == 0 & visit6 == 0 & visit7 == 0 & visit8 == 0, TRUE, FALSE),\n    zero_6_18 = ifelse(visit5 == 0 & visit6 == 0 & visit7 == 0 & visit8 == 0 & visit9 == 0, TRUE, FALSE)) %>%\n  mutate(across(starts_with(\"visit\"), ~ ifelse(.x >= 1, \"severe epilepsy\", \"less severe epilepsy\"), .names = \"severity_{.col}\")) %>%\n  mutate(severity_visit8 = ifelse(zero_0_12 & visit8 == 0, \"seizure-free, treated\", severity_visit8),\n         severity_visit9 = ifelse(zero_3_15 & visit9 == 0, \"seizure-free, treated\", severity_visit9),\n         severity_visit10 = ifelse(zero_6_18 & visit10 == 0, \"seizure-free, treated\", severity_visit9))\n\nseverity_DALY = severity %>% \n  mutate(across(starts_with(\"severity_visit\"), ~ ifelse(.x == \"severe epilepsy\", 0.552, ifelse(.x == \"less severe epilepsy\", 0.263, 0.049)), .names = \"DALYw_{.col}\")) %>% select(-DALYw_severity_visit1) %>%\n  mutate(DALY_2yr = DALYw_severity_visit2 * 1/12 + DALYw_severity_visit3 * 1/12 + DALYw_severity_visit4 * 2/12 + DALYw_severity_visit5 * 2/12 + DALYw_severity_visit6 * 3/12 + DALYw_severity_visit7 * 3/12 + DALYw_severity_visit8 * 3/12 +  DALYw_severity_visit9 * 3/12 + DALYw_severity_visit10 * 6/12)\n\nseverity_DALY %>%\n  group_by(study_arm) %>%\n  summarize(mean(DALY_2yr) / 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2  2\n  study_arm `mean(DALY_2yr)/2`\n  <chr>                  <dbl>\n1 EUC                    0.323\n2 TSC                    0.300\n```\n:::\n:::\n\nincremental cost (in Naira) for TSC - EUC per patient = 3203.91(2-yr) / 2829.74(3-yr)\n\ncurrency exchange rate in 2023: 490.4176 NGN\n\nincremental -DALY **yearly** for TSC - EUC per patient = -0.29992 - (-0.32292) = 0.023\n\n**ICER = 3203.91/(0.023\\*2\\*490.4176) = 142**\n\nCEA threshold: 0.5 \\* GDPpc (2000 dollars in Nigeria) = 1000\n\n### Previous\n\nDALY = YLL + YLD, while the kind and severity of disease will impact the disability weight for YLD.\n\nThe YLD can be computed based on factor of IDWL with uniform age weights and zero discounting, where, I represents the number of incident cases of childhood epilepsy in a reference period, DW is the disability weight (0--1), and L is the mean duration of disability (years) ([Murray and Lopez, 1996](https://www.sciencedirect.com/science/article/pii/S0920121116300699#bib0060)).\n\n**For severe epilepsy: 0.552; For seizure-free, treated epilepsy: 0.049 (GBD, 2016). ---** the severity of disability was weighted between 0 (perfect health) and 1 (equivalent to death).\n\nFor the population, the DALYs will be calculated by disease, country, gender, average age of onset, average age of death, incident cases and incident deaths. -- as the country and gender will determine the life expectancy at age of premature death.\n\nJust for our dataset, it is impossible to gain the individual age of death. So we need to look for the average age of death for childhood epilepsy in Nigeria. -- As few literature in this region, it is hard to get.\n\n**The first way** is to use DALY from literature: 4.1 DALYs per 1000 individuals annually (Wagner, etc, 2015)\\[<https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0145300>\\] or 2.18 DALYs for children within the age group of 5-14 years(Ughasoro, etc, 2016) \\[<https://www.sciencedirect.com/science/article/pii/S0920121116300699>\\]\n\nas both numbers use an average disability weight, it is difficult but able to infer the DALY for severe and seizure free conditions.\n\nAs our 2 arms have different percents of severity, we can calculate the DALYs for each group.\n\n**The second way** serves for the cost-effectiveness.\n\nIncremental effectiveness = DALY_TSC - DALY_EUC = YLL_TSC + YLD_TSC - YLL_EUC - YLD_EUC\n\nAs the two arms we have almost the same onset age, and we will also use the same age of premature death for 2 arms, YLL_TSC = YLL_EUC\n\nIncremental effectiveness = YLD_TSC - YLD_EUC \\~ (Disability_weight_TSC - Disability_weight_EUC) \\* living_years\n\n**Delete**:If compare them **annually per 1000 individuals,** incremental effectiveness using DALY weight for each year for the same population size = **(0.03 \\* 0.552 + 0.97 \\* 0.049) - (0.10 \\* 0.552 + 0.90 \\* 0.049) = -0.03521**\n\nAlthough we can't get an exact DALY for each arm, the cost-effectiveness analysis is more precise.\n\n# Discussion\n\n## Strengths\n\n1.  There's few early literature working on the childhood epilepsy in Nigeria\n2.  It's a long-period treatment with 10 follow-up visits, which is a good chance to observe the development process\n\n## Weakness\n\n1.  The records is not so complete: not all people complete the scale(especially the QOLIE) on the time and meeting the eligibility\n2.  Lots of assumptions has been made to clean the data\n\n## Future work\n\nContent of Aim 3 in the protocol:\n\n**Determine the cost-effectiveness of the task-shifted epilepsy care intervention.**\n\nDirect costs of the intervention and EUC will include personnel costs (including CHEW epilepsy training) and expenses for diagnostic (EEG, brain imaging) and laboratory tests and anti-epileptic drugs.\n\nIndirect costs will include travel time and time away from work for parents/guardians and change in school attendance for patients.\n\nCost-effectiveness will be expressed as US dollars per disability adjusted life year (DALY) averted.\n\nHalf-way to find the effectiveness of TSC.\n",
    "supporting": [
      "bridge_brief_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}